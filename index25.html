<!DOCTYPE html>
<html lang="en">
<head>
  <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,400italic' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" type="text/css" href="http://blog.xivo.io/theme/css/style.min.css">
  <link rel="stylesheet" type="text/css" href="http://blog.xivo.io/theme/css/pygments.min.css">
  <link rel="stylesheet" type="text/css" href="http://blog.xivo.io/theme/css/font-awesome.min.css">
  <link href="http://blog.xivo.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="XiVO Blog Atom">
  <link rel="shortcut icon" href="/public/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/public/favicon.ico" type="image/x-icon">

  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="" />
  <meta name="author" content="XiVO developers" />
  <meta name="description" content="" />
<meta property="og:site_name" content="XiVO Blog"/>
<meta property="og:type" content="blog"/>
<meta property="og:title" content="XiVO Blog"/>
<meta property="og:description" content=""/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="http://blog.xivo.io"/>
<meta property="og:image" content="public/xivo-logo.png">
  <title>XiVO Blog</title>
</head>
<body>
  <aside>
    <div>
      <a href="http://blog.xivo.io">
        <img src="public/xivo-logo.png" alt="" title="">
      </a>
      <h1><a href="http://blog.xivo.io"></a></h1>
      <p></p>
      <nav>
        <ul class="list">
          <li><a href="http://xivo.io" target="_blank">XiVO.io</a></li>
          <li><a href="http://documentation.xivo.io" target="_blank">Documentation</a></li>
        </ul>
      </nav>
      <ul class="social">
        <li><a class="sc-twitter" href="http://twitter.com/xivodevteam" target="_blank"><i class="fa fa-twitter"></i></a></li>
        <li><a class="sc-github" href="http://github.com/xivo-pbx" target="_blank"><i class="fa fa-github"></i></a></li>
        <li><a class="sc-facebook" href="https://www.facebook.com/XiVO-86529730831" target="_blank"><i class="fa fa-facebook"></i></a></li>
      </ul>
    </div>
  </aside>
  <main>
    <nav>
      <a href="http://blog.xivo.io">Home</a>
      <a href="/categories.html">Categories</a>
      <a href="/archives.html">Archives</a>
      <a href="http://blog.xivo.io/feeds/all.atom.xml">Atom</a>
    </nav>

<article>
  <header>
    <h2><a href="http://blog.xivo.io/resolving-xivo-submissions-confusion.html#resolving-xivo-submissions-confusion">resolving XiVO submissions confusion</a></h2>
    <p>
      Posted on Mon 19 September 2011 in <a href="http://blog.xivo.io/category/xivo-ipbx.html">XiVO IPBX</a>
      &#8226; Tagged with
      <a href="http://blog.xivo.io/tag/packages.html">packages</a>    </p>
  </header>
  <div>
      <h4>nothing needs to be done</h4>
<p>The rules that decide when packaging-farm should work on a package are
explained in the manual pages. However, they have changed a lot while
packaging-farm matured in the past months and they deserve a short
summary.The first step is to submit work to the packaging-farm and this
is done by the submit-xivo.sh script as follows:</p>
<div class="highlight"><pre><span></span>packaging-farm DIRECTORY=asterisk submit
</pre></div>


<p>which is run as a side effect of the command</p>
<div class="highlight"><pre><span></span>rebuild
</pre></div>


<p>which is an alias for running the <strong>rebuild</strong> target of the
<strong>/etc/packaging-farm/gallifrey.mk</strong> Makefile.What it really does is to
use the content of the XiVO git repository to create a Debian GNU/Linux
source package. It uses the debian packaging instructions found in the
git repository and follow them : it does not create rules automatically,
it fully relies on what has been done manually. It does, however,
creates the package version according to a complex set of rules,
explained in the VERSIONS section of the submit-xivo.sh.The asterisk
source package will not be generated each time the</p>
<div class="highlight"><pre><span></span>packaging-farm DIRECTORY=asterisk submit
</pre></div>


<p>is run for two reasons:</p>
<ul>
<li>To save time. It currently takes less than 30 seconds for
    packaging-farm to update the <strong>skaro</strong> build machine when nothing
    needs to be done. If the source packages were always rebuilt it
    would take at least 15 minutes.</li>
<li>To avoid checksum errors when reprepro mirrors the packages built
    by packaging-farm. When a <strong>.orig.tar.gz</strong> is built for a given
    version of a package, it is preserved. Even when the content of two
    <strong>.tar.gz</strong> are strictly identical, the file itself has a different
    md5sum signature because of the compression.</li>
</ul>
<p>The submit-xivo.sh script decides if a source package should be rebuilt
using a simple comparison : if the existing <strong>.dsc</strong> file has the same
path as the one that would be created, it declares there is no need to
re-create it. In other words, the decision to rebuild a source package
solely depends on the version number of the package.Note that when
submit-xivo.sh decides that nothing needs to be done, it does not rely
on the log history of the git repository. It only relies on the version
number. However, when <strong>VERSION_COMPUTE=true</strong> (which is the default)
the date and time of the last commit from the git repository is used to
create the version number. Therefore there is a relationship between the
history of the git repository and the decision to recreate the source
package because each new commit will create a new version.This
relationship no longer exists when <strong>VERSION_COMPUTE=false</strong> and
commits to the git repository will not have any consequence on the
decision to rebuild a source package.</p>
<h4>manually submitted packages</h4>
<p>Some packages are not yet in the git repositories and they are completly
outside the control of submit-xivo.sh. As a consequence they must be
submitted manually to packaging farm. The</p>
<div class="highlight"><pre><span></span>rebuild
</pre></div>


<p>command will not submit these packages because:</p>
<ul>
<li>it would create checksum errors when the same package version is
    submitted twice</li>
<li>it would uselessly slow down the command when nothing needs update</li>
</ul>
<p>The list of packages that need manual care is found in the
<strong>/etc/packaging-farm/gallifrey.mk</strong> or <strong>/etc/packaging-farm/skaro.mk</strong>
files:</p>
<div class="highlight"><pre><span></span><span class="x">cd /var/cache/packaging-farm/sources</span>
<span class="x">for package in asterisk-chan-capi libasterisk-perl libpri misdn-kernel misdn-user sangoma-wanpipe spandsp</span>
<span class="x">do ( rm -fr </span><span class="p">$</span><span class="nv">package</span><span class="x"> ; mkdir </span><span class="p">$</span><span class="nv">package</span><span class="x"> ; cd </span><span class="p">$</span><span class="nv">package</span><span class="x"> ; apt-get source </span><span class="p">$</span><span class="nv">package</span><span class="x"> </span>
<span class="x">      rm -f /var/cache/packaging-farm/depends/</span><span class="p">$</span><span class="nv">package</span><span class="x"> )</span>
<span class="x">done ; packaging-farm generate</span>
</pre></div>


<p>Note however that this is merely a reminder and running it without
evaluating the consequences may lead to checksum errors. The following
should be checked:</p>
<ul>
<li>from which source will the package be retrieved ?</li>
<li>which package version will be retrieved ?</li>
<li>is the package retrieved compatible with the other package in the
    build farm ?</li>
<li>is there already a package with the same version in the
    /var/cache/packaging-farm/source/package directory ?</li>
</ul>
<h4>checksum errors</h4>
<p>The gallifrey and skaro build machines output is a repository created
with reprepro. It is then mirrored, using reprepro, to mirror.xivo.fr.If
the build machines were lost and had to be reinstalled manually, all
packages would be rebuilt. As a consequence, trying to update the mirror
on mirror.xivo.fr would lead to checksum errors because both the sources
and binary files would have the same name and different checksum,
because of the same content has a different checksum after compression,
either in a <strong>.tar.gz</strong> or in a <strong>.deb</strong> . The only way to recover from
such a situation would be to :</p>
<ul>
<li>identify all packages that are to be rebuilt by the farm</li>
<li>dget from mirror.xivo.fr each of them in
    /var/lib/packaging-farm/package</li>
<li>rebuild the gallifrey / skaro meta package</li>
</ul>
<p>Doing so is, in a nutshell, re-importing the packages saved on
mirror.xivo.fr back to the build machine, as if it was the result
created with it. The actual restoration of such a catastrophic event is
likely to be more complicated in reality. But the general idea is simple
enough.A more common problem comes from the fact that mirror.xivo.fr is
a single reprepro repository that is used to merge unrelated
repositories. For instance gallifrey, gallifrey-dev, skaro, skaro-dev
and so on. Because reprepro has a single package pool shared between all
distributions, if package P-1.1.1-1 has been built on gallifrey and
gallifrey-dev, it will be imported twice with the same version but
different checksum and lead to a checksum error. There are two ways to
avoid this problem:</p>
<ul>
<li>manually ensure that such a case never happens (for instance by
    setting the VERSION_FLAVOR veriable of submit-xivo.sh to add a
    distinctive string unique to the distribution in the name of
    each package).</li>
<li>create a separate reprepro repository for each distribution</li>
</ul>
<h4>misleading error message</h4>
<p>When nothing needs to be done according to submit-xivo.sh, it shows</p>
<div class="highlight"><pre><span></span>package <span class="cp">${</span><span class="n">package</span><span class="cp">}</span> was not modified in git since the last package generation
</pre></div>


<p><a href="http://packaging-farm.dachary.org/trac/ticket/22">although it is unrelated to
git</a> when
VERSION_COMPUTE=false.The message explaining that no update is needed
is <a href="http://packaging-farm.dachary.org/trac/changeset/d6c8676bd54b95b76ce475d7fe7dbe0d2592aafa">moved to the need_update
function</a>
and displays the exact reason, path included, why no update is required.</p>
</p>
  </div>
  <hr />
</article>
<article>
  <header>
    <h2><a href="http://blog.xivo.io/after-the-summer-an-active-start-for-xivo-open-hardware.html#after-the-summer-an-active-start-for-xivo-open-hardware">After the summer, an active start for XiVO Open Hardware !</a></h2>
    <p>
      Posted on Tue 13 September 2011 in <a href="http://blog.xivo.io/category/general.html">General</a>
    </p>
  </header>
  <div>
      <p>No doubt, XiVO Open Hardware creates much interest and Avencall teams
will demonstrate the project in different events in the coming months.</p>
<ul>
<li>On September 15 th , we will be at Open Hardware Summit in New York,
    THE worldwide event about Open Hardware. We are in the breakout
    sessions with <a href="http://www.openhardwaresummit.org/breakouts/" title="Open Hardware Summit">"Open Hardware in Voice
    Telecommunications"</a> .</li>
</ul>
<!-- -->

<ul>
<li>On September 17 th , we will be at Software Freedom Day in Montreal
    for a talk at 1pm <a href="http://wiki.softwarefreedomday.org/2011/Canada/Montreal/SFD-ETS" title="Software Freedom Day">“Xivo: aller plus loin que le logiciel libre,
    libérer le matériel aussi (VoIP,
    Asterisk)”</a> .</li>
</ul>
<!-- -->

<ul>
<li>On September 22 nd , we will be at Open World Forum in Paris for a
    track <a href="http://www.openworldforum.org/Conferences/The-OpenHardware-movement-The-community-is-moving-from-software-to-hardware" title="Open World Forum">“The OpenHardware movement - The community is moving from
    software to
    hardware”</a>.
    The Open World Forum is the first Open Source Forum in Europe.</li>
</ul>
<!-- -->

<ul>
<li>On October, 26 th (10:00-10:35am), we will be at Astricon, the First
    Asterisk User Conference in the world, for the track <a href="http://www.astricon.net/conferenceProgram.aspx" title="Astricon2011">"XiVO IPBX
    OpenHardware: a full-open telephony solution for
    SOHO"</a> .
    This is a great opportunity to develop our XiVO Open
    Hardware community.</li>
</ul>
<p>And don’t forget, from October 18-21, two tradeshows: <a href="http://www.ipconvergence.fr/" title="IP Convergence">IP
Convergence</a> and <a href="/index.php?post/2011/07/29/AVENCALL-at-GIF-2011" title="IP Convergence">GIF
2011</a>
where we will make some demonstrations of XiVO Open Hardware.</p>
<p>Come to visit us !</p>
</p>
  </div>
  <hr />
</article>
<article>
  <header>
    <h2><a href="http://blog.xivo.io/xivo-submission-configuration.html#xivo-submission-configuration">XiVO submission configuration</a></h2>
    <p>
      Posted on Mon 12 September 2011 in <a href="http://blog.xivo.io/category/xivo-ipbx.html">XiVO IPBX</a>
      &#8226; Tagged with
      <a href="http://blog.xivo.io/tag/packages.html">packages</a>    </p>
  </header>
  <div>
      <h4>clearing the generated sources</h4>
<p>When some environment variables used by submit-xivo.sh change value, the
whole source directory <a href="http://packaging-farm.dachary.org/trac/ticket/21">must be
regenerated</a>. For
instance, the VERSION_FLAVOR variable change the name of each source
package. If the maintainer forgets to remove
/var/cache/packaging-farm/sources, a mix of packages using different
naming conventions is used and creates a very confusing situation.</p>
<p>Although it would be possible and safe to wipe out the cache (i.e.
/var/cache/packaging-farm/sources) each time the environment changes,
that would be overkill. For instance if setting VERBOSE=true has this
effect, it would be inconvenient. Instead, a set of <a href="http://packaging-farm.dachary.org/trac/changeset/5a601108bb90a2bbf2dfbdd2a330700d980c2e23">variables is chosen
and their content written into a file after each
run</a>
of submit-xivo.sh. When submit-xivo.sh is run, the content of the file
from the previous run is matched against the values of the variables in
the environment. If it turns out that they are not the same, the
directory /var/cache/packaging-farm/sources is removed and will be fully
repopuplated.</p>
<h4>example file</h4>
<p>Although each environment variable for the submit-xivo.sh script is
documented in the submit-xivo.sh manual page, it is much more convenient
to change values from a commented configuration file that shows all the
expected default values. The <strong>/etc/packaging-farm/submit-xivo.conf</strong>
file was created for this purpose.</p>
<div class="highlight"><pre><span></span><span class="err">#</span><span class="x"></span>
<span class="err">#</span><span class="x"> The submit-xivo.sh(1) configuration file. </span>
<span class="err">#</span><span class="x"> In the following each line starting with </span><span class="cp">#</span><span class="nf">export</span><span class="x"> shows the default</span>
<span class="err">#</span><span class="x"> value of the corresponding environment variable. For instance</span>
<span class="err">#</span><span class="x"> export XIVO=skaro shows that the default value of the &quot;XIVO&quot; variable</span>
<span class="err">#</span><span class="x"> is the string &quot;skaro&quot;. </span>
<span class="err">#</span><span class="x"> The line can be uncommented and the value changed. The change will take</span>
<span class="err">#</span><span class="x"> effect which the next packaging-farm(1) command is run.</span>
<span class="err">#</span><span class="x"></span>
<span class="cp">##</span><span class="c">######################################################################</span><span class="x"></span>
<span class="err">#</span><span class="x"></span>
<span class="err">#</span><span class="x"> The name of the skaro distribution. Can be one of skaro, gallifrey.</span>
<span class="err">#</span><span class="x"></span>
<span class="cp">#</span><span class="nf">export</span><span class="x"> XIVO=skaro</span>
<span class="err">#</span><span class="x"></span>
<span class="cp">##</span><span class="c">######################################################################</span><span class="x"></span>
<span class="err">#</span><span class="x"></span>
<span class="err">#</span><span class="x"> A Debian GNU/Linux suite. Can be one of squeeze, lenny.</span>
<span class="err">#</span><span class="x"></span>
<span class="cp">#</span><span class="nf">export</span><span class="x"> SUITE=squeeze</span>
<span class="err">#</span><span class="x"></span>
<span class="cp">##</span><span class="c">######################################################################</span><span class="x"></span>
<span class="err">#</span><span class="x"></span>
<span class="err">#</span><span class="x"> The directory in which the source and debian repositories will be</span>
<span class="err">#</span><span class="x"> cloned.</span>
<span class="err">#</span><span class="x"></span>
<span class="cp">#</span><span class="nf">export</span><span class="x"> VCS_DIR=/var/cache/packaging-farm/VCS</span>
<span class="err">#</span><span class="x"></span>
<span class="cp">##</span><span class="c">######################################################################</span><span class="x"></span>
<span class="err">#</span><span class="x"></span>
<span class="err">#</span><span class="x"> The directory in which the resulting source packages will be stored.</span>
<span class="err">#</span><span class="x"></span>
<span class="err">#</span><span class="x"> PACKAGES_DIR=/var/cache/packaging-farm/sources</span>
<span class="err">#</span><span class="x"></span>
<span class="cp">##</span><span class="c">######################################################################</span><span class="x"></span>
<span class="err">#</span><span class="x"></span>
<span class="err">#</span><span class="x"> The content of this variable is appended to the value found in the</span>
<span class="err">#</span><span class="x"> VERSION file and may be used to distinguish from a development</span>
<span class="err">#</span><span class="x"> version and a production version for instance.  VERSION_FLAVOR=-dev</span>
<span class="err">#</span><span class="x"></span>
<span class="cp">#</span><span class="nf">export</span><span class="x"> VERSION_FLAVOR=</span>
<span class="err">#</span><span class="x"></span>
<span class="cp">##</span><span class="c">######################################################################</span><span class="x"></span>
<span class="err">#</span><span class="x"></span>
<span class="err">#</span><span class="x"> By default each source version number is created by computing the</span>
<span class="err">#</span><span class="x"> current time and extracting the last commit hash from the source</span>
<span class="err">#</span><span class="x"> repository (see the VERSION section above.  If VERSION_COMPUTE is</span>
<span class="err">#</span><span class="x"> set to false then the current time and last commit hash are not used</span>
<span class="err">#</span><span class="x"> when generating the version number.</span>
<span class="err">#</span><span class="x"></span>
<span class="cp">#</span><span class="nf">export</span><span class="x"> VERSION_COMPUTE=true</span>
<span class="err">#</span><span class="x"></span>
<span class="cp">##</span><span class="c">######################################################################</span><span class="x"></span>
<span class="err">#</span><span class="x"></span>
<span class="err">#</span><span class="x"> The gitrevision(7) from which both source and debian git will be</span>
<span class="err">#</span><span class="x"> checked out. If the GIT_REVISION designates a branch, the latest</span>
<span class="err">#</span><span class="x"> changes will be pulled from it.  If  GIT_REVISION  designates  a</span>
<span class="err">#</span><span class="x"> tag, it will be checked out.</span>
<span class="err">#</span><span class="x"></span>
<span class="cp">#</span><span class="nf">export</span><span class="x"> GIT_REVISION=master</span>
<span class="err">#</span><span class="x"></span>
<span class="cp">##</span><span class="c">######################################################################</span><span class="x"></span>
<span class="err">#</span><span class="x"></span>
<span class="err">#</span><span class="x"> The SOURCE_GIT and DEBIAN_GIT repositories will be pulled only if</span>
<span class="err">#</span><span class="x"> the last pull occured more than GIT_CACHE_MINUTES minutes ago.  By</span>
<span class="err">#</span><span class="x"> default it is pull every time (i.e. if the last pull occured more</span>
<span class="err">#</span><span class="x"> than zero minutes ago). It can be used to reduce the number of pull</span>
<span class="err">#</span><span class="x"> occuring when running many submit-xivo in sequence.</span>
<span class="err">#</span><span class="x"></span>
<span class="cp">#</span><span class="nf">export</span><span class="x"> GIT_CACHE_MINUTES=0</span>
<span class="err">#</span><span class="x"></span>
<span class="cp">##</span><span class="c">######################################################################</span><span class="x"></span>
<span class="err">#</span><span class="x"></span>
<span class="err">#</span><span class="x"> The directory containing the source code repositories for each XiVO</span>
<span class="err">#</span><span class="x"> suite.</span>
<span class="err">#</span><span class="x"></span>
<span class="cp">#</span><span class="nf">export</span><span class="x"> SOURCE_GIT=git://git.proformatique.com/official</span>
<span class="err">#</span><span class="x"></span>
<span class="cp">##</span><span class="c">######################################################################</span><span class="x"></span>
<span class="err">#</span><span class="x"></span>
<span class="err">#</span><span class="x"> the directory name within the SOURCE_GIT repository where the</span>
<span class="err">#</span><span class="x"> sources can be found.  The package name will be infered from the</span>
<span class="err">#</span><span class="x"> content of the Makefile.pkg file within this directory. For instance</span>
<span class="err">#</span><span class="x"> DIRECTORY=web-interface submit-xivo.sh will submit the package</span>
<span class="err">#</span><span class="x"> pf-xivo-web-interface</span>
<span class="err">#</span><span class="x"></span>
<span class="cp">#</span><span class="nf">export</span><span class="x"> DIRECTORY=</span>
<span class="err">#</span><span class="x"></span>
<span class="cp">##</span><span class="c">######################################################################</span><span class="x"></span>
<span class="err">#</span><span class="x"></span>
<span class="err">#</span><span class="x"> The directory containing the Debian GNU/Linux repositories for each</span>
<span class="err">#</span><span class="x"> XiVO suite.</span>
<span class="err">#</span><span class="x"></span>
<span class="cp">#</span><span class="nf">export</span><span class="x"> DEBIAN_GIT=git://git.proformatique.com/official</span>
<span class="err">#</span><span class="x"></span>
<span class="cp">##</span><span class="c">######################################################################</span><span class="x"></span>
<span class="err">#</span><span class="x"></span>
<span class="err">#</span><span class="x"> the directory name within the DEBIAN_GIT repository where the</span>
<span class="err">#</span><span class="x"> package can be found.  The submit-xivo.sh command will not attempt</span>
<span class="err">#</span><span class="x"> to locate a source in the SOURCE_GIT repository. It will submit a</span>
<span class="err">#</span><span class="x"> package that has the same name as the content of the NOSOURCE=</span>
<span class="err">#</span><span class="x"> variable. For instance NOSOURCE=pf-xivo will submit the pf-xivo</span>
<span class="err">#</span><span class="x"> package. The version number of the package is either the one found</span>
<span class="err">#</span><span class="x"> in the debian/changelog, if it contains the con- tent of the VERSION</span>
<span class="err">#</span><span class="x"> file found in the SOURCE_GIT repository. For instance if the first</span>
<span class="err">#</span><span class="x"> line of the debian/changelog contains 8:1.1.16~5 and the VERSION</span>
<span class="err">#</span><span class="x"> file contains 1.1.16 it won&#39;t be mod- ified. However, if VERSION</span>
<span class="err">#</span><span class="x"> contains 1.1.17 a debian/changelog line will be added, preserving</span>
<span class="err">#</span><span class="x"> the epoch and will contain 8:1.1.17.</span>
<span class="err">#</span><span class="x"></span>
<span class="cp">#</span><span class="nf">export</span><span class="x"> NOSOURCE=</span>
<span class="err">#</span><span class="x"></span>
<span class="cp">##</span><span class="c">######################################################################</span><span class="x"></span>
<span class="err">#</span><span class="x"></span>
<span class="err">#</span><span class="x"> If set to true, no changes will be committed to the Debian GNU/Linux</span>
<span class="err">#</span><span class="x"> repository if a debian/changelog entry is added.</span>
<span class="err">#</span><span class="x"></span>
<span class="cp">#</span><span class="nf">export</span><span class="x"> GIT_DRY_RUN=false</span>
<span class="err">#</span><span class="x"></span>
<span class="cp">##</span><span class="c">######################################################################</span><span class="x"></span>
<span class="err">#</span><span class="x"></span>
<span class="err">#</span><span class="x"> The mail used when generating a debian/changelog entry.</span>
<span class="err">#</span><span class="x"></span>
<span class="cp">#</span><span class="nf">export</span><span class="x"> DEBEMAIL=technique@proformatique.com</span>
<span class="err">#</span><span class="x"></span>
<span class="cp">##</span><span class="c">######################################################################</span><span class="x"></span>
<span class="err">#</span><span class="x"></span>
<span class="err">#</span><span class="x"> The user name used when generating a debian/changelog entry.</span>
<span class="err">#</span><span class="x"></span>
<span class="cp">#</span><span class="nf">export</span><span class="x"> DEBFULLNAME=&quot;Proformatique Maintainance Team&quot;</span>
<span class="err">#</span><span class="x"></span>
<span class="cp">##</span><span class="c">######################################################################</span><span class="x"></span>
<span class="err">#</span><span class="x"></span>
<span class="err">#</span><span class="x"> Before the debian directory is assembled with the source directory,</span>
<span class="err">#</span><span class="x"> a copy is made using rsync(1).  The content of the RSYNC_OPTIONS</span>
<span class="err">#</span><span class="x"> variable is given in argument to the rsync command. For instance it</span>
<span class="err">#</span><span class="x"> may be used to collect the actual content of symbolic links pointing</span>
<span class="err">#</span><span class="x"> outside of the source directory.</span>
<span class="err">#</span><span class="x"></span>
<span class="err">#</span><span class="x"> for dir in app_nv_faxdetect app_fax ami_aoriginate module_xivo res_config_sqlite ;</span>
<span class="err">#</span><span class="x">  do RSYNC_OPTIONS=--copy-unsafe-links packaging-farm DIRECTORY=</span><span class="p">$</span><span class="nv">dir</span><span class="x"> submit ;</span>
<span class="err">#</span><span class="x"> done</span>
<span class="err">#</span><span class="x"></span>
<span class="cp">#</span><span class="nf">export</span><span class="x"> RSYNC_OPTIONS=</span>
</pre></div>


<p>The inclusion of the configuration file is documented in the
submit-xivo.sh manual page:</p>
<div class="highlight"><pre><span></span>When this script is called as a side effect of packaging-farm(1) it can
       be   configured   system  wide  using  the  /etc/packaging-farm/submit-
       xivo.conf example configuration file, which can then be included in the
       global packaging-farm.conf(5) file located in /etc/packaging-farm/pack-
       aging-farm.conf For instance, the line

              export VERSION_COMPUTE=false

       can be added to override the default.
</pre></div>


</p>
  </div>
  <hr />
</article>
<article>
  <header>
    <h2><a href="http://blog.xivo.io/rebuilding-xivo-gallifrey.html#rebuilding-xivo-gallifrey">Rebuilding XiVO gallifrey</a></h2>
    <p>
      Posted on Mon 05 September 2011 in <a href="http://blog.xivo.io/category/xivo-ipbx.html">XiVO IPBX</a>
      &#8226; Tagged with
      <a href="http://blog.xivo.io/tag/packages.html">packages</a>    </p>
  </header>
  <div>
      <h4>rebuilding gallifrey</h4>
<p>The /var/cache/packaging-farm/sources directory was removed and</p>
<div class="highlight"><pre><span></span>export VERSION_COMPUTE=false
</pre></div>


<p>set in /etc/packaging-farm/packaging-farm.conf and
<code>packaging-farm --cd gallifrey rebuild</code> was run to rebuild gallifrey
from scratch. It took 42 minutes total. The purpose of this complete
rebuild was to get rid of the timestamp and hash that were previously
part of the version number.</p>
<h4>compatibility between sangoma-wanpipe and dahdi-linux</h4>
<p>The build of the gallifrey development packages was blocked because of a
compilation error.</p>
<div class="highlight"><pre><span></span>...
/usr/src/sangoma-wanpipe-3.5.17.dfsg.1/kdrvtmp/sdla_tdmv.c:1504: error: &#39;DAHDI_MAINT_LOOPSTOP&#39; undeclared (first use in this function)
/usr/src/sangoma-wanpipe-3.5.17.dfsg.1/kdrvtmp/sdla_tdmv.c: In function &#39;wp_tdmv_rx_dchan&#39;:
/usr/src/sangoma-wanpipe-3.5.17.dfsg.1/kdrvtmp/sdla_tdmv.c:2516: error: &#39;struct dahdi_chan&#39; has no member named &#39;readbufq&#39;
/usr/src/sangoma-wanpipe-3.5.17.dfsg.1/kdrvtmp/sdla_tdmv.c:2517: error: &#39;struct dahdi_chan&#39; has no member named &#39;sel&#39;
/usr/src/sangoma-wanpipe-3.5.17.dfsg.1/kdrvtmp/sdla_tdmv.c:2519: error: &#39;struct dahdi_chan&#39; has no member named &#39;eventbufq&#39;
make[6]: *** [/usr/src/sangoma-wanpipe-3.5.17.dfsg.1/kdrvtmp/sdla_tdmv.o] Error 1
make[5]: *** [_module_/usr/src/sangoma-wanpipe-3.5.17.dfsg.1/kdrvtmp] Error 2
make[4]: *** [all] Error 2

---------------------------------------------

make[3]: *** [common-build-impl] Error 1
dpkg-buildpackage: failure: debian/rules build gave error exit status 2
BUILD END packaging-farm --cd sangoma-wanpipe ARCHITECTURE=i386 DISTRIBUTION=lenny chroot-login
</pre></div>


<p>To debug the problem, the following command was used to go in the chroot
where it can be reproduced:</p>
<div class="highlight"><pre><span></span>packaging-farm --cd sangoma-wanpipe ARCHITECTURE=i386 DISTRIBUTION=lenny chroot-login
</pre></div>


<p>The compilation error:</p>
<div class="highlight"><pre><span></span>/usr/src/sangoma-wanpipe-3.5.20.dfsg.1/kdrvtmp/sdla_tdmv.c:352: error: unknown field &#39;name&#39; specified in initializer
</pre></div>


<p>is in <code>/usr/src/sangoma-wanpipe-3.5.20.dfsg.1/kdrvtmp/sdla_tdmv.c</code></p>
<div class="highlight"><pre><span></span>static const struct dahdi_echocan_ops wp_tdmv_ec_ops = {
        .name = &quot;WANPIPE_HWEC&quot;,
        .echocan_free = wp_tdmv_hwec_free,
};
</pre></div>


<p>and comes from the fact that <code>/usr/include/dahdi/kernel.h</code> which is part
of</p>
<div class="highlight"><pre><span></span>ii  dahdi-linux-dev                 1:2.5.0+pf.xivo.1.1.18~20110820.120254.7b98919-1 DAHDI telephony interface (source code
</pre></div>


<p>contains</p>
<div class="highlight"><pre><span></span>struct dahdi_echocan_ops {

        /*! \brief Free an echocan state structure.                                                                                                             
         * \param[in,out] ec Pointer to the state structure to free.                                                                                            
         *                                                                                                                                                      
         * \
eturn Nothing.                                                                                                                                     
         */
        void (*echocan_free)(struct dahdi_chan *chan, struct dahdi_echocan_state *ec);
...
</pre></div>


<p>and does not contain the <code>name</code> field which means that
<code>sangoma-wanpipe-3.5.20</code> is not compatible with
<code>dahdi-linux-dev 1:2.5.0</code></p>
<h4>kernel-module dependencies</h4>
<p>Nicolas Hicher faced a problem because <a href="http://packaging-farm.dachary.org/trac/ticket/19">kernel-modules dependencies did
not work</a>. The
dependency graph generated is wrong: it mentions the stamp files but do
not assemble them properly. As a result the kernel-module is not rebuilt
when the module is rebuilt. The make_graph and make_build functions
<a href="are%20assembled%20into%20a%20single%20functionhttp://packaging-farm.dachary.org/trac/changeset/d561c3d271e26651c2f94f96d343d7d33070eb60" title="are assembled into a single functionhttp://packaging-farm.dachary.org/trac/changeset/d561c3d271e26651c2f94f96d343d7d33070eb60">are assembled into a single
functio...</a>|
so that the rule generated lists the timestamp files of the
dependencies.</p>
<h4>Makefiles moved to /etc/packaging-farm</h4>
<p>The fact that Makefiles describing how a given package must be built are
expected to be in /var/cache/packaging-farm <a href="http://packaging-farm.dachary.org/trac/ticket/20">is
confusing</a>. In
addition, they are copied in /var/lib/packaging-farm after the package
is successfully built. As a result the system administrator is led to
think that /var/lib/packaging-farm/package/Makefile is the file to be
edited although it will be overridden the next time a package is
built.The makefiles <a href="http://packaging-farm.dachary.org/trac/changeset/6450d8785be6406a5e1d1d205df23be04279f736">are moved from
/var/cache/packaging-farm/build/package/Makefile to
/etc/packaging-farm/package.mk</a>.
To ensure the compatibility with the existing scripts, a symbolic link
is created from /var/cache/packaging-farm/build/package/Makefile to
/etc/packaging-farm/package.mk by the makefiles.sh script.The manual
page is updated to remove references to the former build directory. The
additional benefit of having the .mk files in /etc/packaging-farm is
that they can be saved by etckeeper and backed up with /etc.The build
machines for gallifrey, gallifrey-dev and skaro were migrated to the new
convention.</p>
</p>
  </div>
  <hr />
</article>
<article>
  <header>
    <h2><a href="http://blog.xivo.io/xivo-package-versioning.html#xivo-package-versioning">XiVO package versioning</a></h2>
    <p>
      Posted on Mon 29 August 2011 in <a href="http://blog.xivo.io/category/xivo-ipbx.html">XiVO IPBX</a>
      &#8226; Tagged with
      <a href="http://blog.xivo.io/tag/packages.html">packages</a>    </p>
  </header>
  <div>
      <h4>production version conventions</h4>
<p>XiVO package release numbers <a href="http://packaging-farm.dachary.org/trac/ticket/16">must not contain the timestamp +
hash</a>. When upgrading
from a development machine to a production machine, the package numbers
for production are lexicographically lower than the package numbers for
development. For instance 1.1.15<a></a> in a special way as documented
in the dpkg-version manual page:</p>
<div class="highlight"><pre><span></span>The lexical compar‐
 ison is a comparison of ASCII values modified so that all the letters sort earlier than all the non-letters and so
 that a tilde sorts before anything, even the end of a part.  For example, the following parts are in sorted order:
 &#39;~~&#39;, &#39;~~a&#39;, &#39;~&#39;, the empty part, &#39;a&#39;.
</pre></div>


<p>This created somme confusion as demonstrated in the chat log below</p>
<div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">05</span><span class="s s-Atom">:</span><span class="mi">15</span><span class="s s-Atom">:</span><span class="mi">22</span> <span class="nv">PM</span><span class="p">)</span> <span class="nn">guillaumeb</span><span class="p">:</span> <span class="nn">dachary</span><span class="p">:</span> <span class="s s-Atom">pourquoi</span> <span class="s s-Atom">on</span> <span class="s s-Atom">conserve</span> <span class="s s-Atom">la</span> <span class="s s-Atom">date</span><span class="o">/</span><span class="s s-Atom">le</span> <span class="s s-Atom">n°</span> <span class="s s-Atom">de</span> <span class="s s-Atom">commit</span> <span class="s s-Atom">dans</span> <span class="s s-Atom">les</span> <span class="s s-Atom">paquets</span> <span class="s s-Atom">de</span> <span class="s s-Atom">prod</span> <span class="s s-Atom">?</span>
<span class="p">(</span><span class="mi">05</span><span class="s s-Atom">:</span><span class="mi">42</span><span class="s s-Atom">:</span><span class="mi">23</span> <span class="nv">PM</span><span class="p">)</span> <span class="nn">dachary</span><span class="p">:</span> <span class="nn">guillaumeb</span><span class="p">:</span> <span class="s s-Atom">la</span> <span class="s s-Atom">date</span> <span class="s s-Atom">c&#39;est pour avoir une numérotation chronologique. Le numéro de hash c&#39;est</span> <span class="s s-Atom">pour</span> <span class="s s-Atom">avoir</span> <span class="s s-Atom">une</span> <span class="s s-Atom">façon</span> <span class="s s-Atom">de</span> <span class="s s-Atom">trouver</span> <span class="s s-Atom">a</span> <span class="s s-Atom">quel</span> <span class="s s-Atom">commit</span> <span class="s s-Atom">ça</span> <span class="s s-Atom">correspond</span> <span class="s s-Atom">dans</span> <span class="s s-Atom">le</span> <span class="s s-Atom">git</span><span class="p">.</span> 
<span class="p">(</span><span class="mi">05</span><span class="s s-Atom">:</span><span class="mi">52</span><span class="s s-Atom">:</span><span class="mi">32</span> <span class="nv">PM</span><span class="p">)</span> <span class="nn">guillaumeb</span><span class="p">:</span> <span class="nn">dachary</span><span class="p">:</span> <span class="s s-Atom">oui</span><span class="p">,</span> <span class="s s-Atom">mais</span> <span class="s s-Atom">pour</span> <span class="s s-Atom">les</span> <span class="nf">releases</span> <span class="p">(</span><span class="s s-Atom">du</span> <span class="s s-Atom">temps</span> <span class="s s-Atom">de</span> <span class="s s-Atom">git</span><span class="o">/</span><span class="s s-Atom">nono</span><span class="p">),</span> <span class="s s-Atom">on</span> <span class="s s-Atom">virait</span> <span class="s s-Atom">le</span> <span class="s s-Atom">numéro</span> <span class="s s-Atom">de</span> <span class="s s-Atom">commit</span> <span class="s s-Atom">dans</span> <span class="s s-Atom">la</span> <span class="s s-Atom">version</span> <span class="s s-Atom">du</span> <span class="nf">paquet</span>
<span class="p">(</span><span class="mi">05</span><span class="s s-Atom">:</span><span class="mi">54</span><span class="s s-Atom">:</span><span class="mi">16</span> <span class="nv">PM</span><span class="p">)</span> <span class="nn">dachary</span><span class="p">:</span> <span class="nn">guillaumeb</span><span class="p">:</span> <span class="s s-Atom">je</span> <span class="s s-Atom">pourrais</span> <span class="s s-Atom">rajouter</span> <span class="s s-Atom">cette</span> <span class="s s-Atom">fonctionalité</span> <span class="s s-Atom">dans</span> <span class="s s-Atom">le</span> <span class="s s-Atom">script</span> <span class="s s-Atom">de</span> <span class="s s-Atom">soumission</span><span class="p">.</span> <span class="nv">Je</span> <span class="s s-Atom">n&#39;avais pas réalisé qu&#39;elle</span> <span class="s s-Atom">existait</span><span class="p">.</span>
<span class="p">(</span><span class="mi">05</span><span class="s s-Atom">:</span><span class="mi">55</span><span class="s s-Atom">:</span><span class="mi">01</span> <span class="nv">PM</span><span class="p">)</span> <span class="nn">guillaumeb</span><span class="p">:</span> <span class="s s-Atom">parce</span> <span class="s s-Atom">qu&#39;il semble que là ça pose un pb pour les migrations (le script ne doit pas correctement gérer le &#39;~...&#39;)</span>
<span class="s s-Atom">(05:55:58 PM) dachary: guillaumeb: c&#39;est</span> <span class="s s-Atom">clair</span> <span class="s s-Atom">que</span> <span class="s s-Atom">toute</span> <span class="s s-Atom">déviation</span> <span class="s s-Atom">du</span> <span class="s s-Atom">modèle</span> <span class="s s-Atom">établit</span> <span class="s s-Atom">est</span> <span class="s s-Atom">une</span> <span class="s s-Atom">menace</span> <span class="s s-Atom">de</span> <span class="s s-Atom">péter</span> <span class="s s-Atom">la</span> <span class="s s-Atom">compatibilité</span><span class="p">.</span> 
<span class="p">(</span><span class="mi">05</span><span class="s s-Atom">:</span><span class="mi">56</span><span class="s s-Atom">:</span><span class="mi">28</span> <span class="nv">PM</span><span class="p">)</span> <span class="nn">dachary</span><span class="p">:</span> <span class="nn">guillaumeb</span><span class="p">:</span> <span class="s s-Atom">tu</span> <span class="s s-Atom">peux</span> <span class="s s-Atom">me</span> <span class="s s-Atom">décrire</span> <span class="s s-Atom">l&#39;algo de nono pour la gestion de la numérotation pour la release ? </span>
<span class="s s-Atom">(05:57:31 PM) dachary: foo-1.1.1~svn283-1 puis foo-1.1.1-1 ca marcherait pas donc ca doit etre autre chose</span>
<span class="s s-Atom">(06:04:19 PM) guillaumeb: dachary: je ne connais pas l&#39;algo</span> <span class="s s-Atom">dans</span> <span class="s s-Atom">le</span> <span class="nf">détail</span>
<span class="p">(</span><span class="mi">06</span><span class="s s-Atom">:</span><span class="mi">04</span><span class="s s-Atom">:</span><span class="mi">51</span> <span class="nv">PM</span><span class="p">)</span> <span class="nn">guillaumeb</span><span class="p">:</span> <span class="s s-Atom">mais</span> <span class="s s-Atom">par</span> <span class="s s-Atom">exemple</span><span class="p">,</span> <span class="s s-Atom">en</span> <span class="mf">1.1.14</span><span class="p">,</span> <span class="s s-Atom">la</span> <span class="s s-Atom">version</span> <span class="s s-Atom">de</span> <span class="s s-Atom">pf</span><span class="o">-</span><span class="s s-Atom">xivo</span><span class="o">-</span><span class="s s-Atom">web</span><span class="o">-</span><span class="s s-Atom">interface</span> <span class="s s-Atom">était</span> <span class="mi">7</span><span class="s s-Atom">:</span><span class="mf">1.1.14</span><span class="o">-</span><span class="mi">1</span>
<span class="p">(</span><span class="mi">06</span><span class="s s-Atom">:</span><span class="mi">05</span><span class="s s-Atom">:</span><span class="mi">47</span> <span class="nv">PM</span><span class="p">)</span> <span class="nn">dachary</span><span class="p">:</span> <span class="s s-Atom">je</span> <span class="s s-Atom">vois</span> <span class="s s-Atom">pas</span> <span class="s s-Atom">comment</span> <span class="s s-Atom">faire</span> <span class="s s-Atom">pour</span> <span class="s s-Atom">avoir</span> <span class="s s-Atom">une</span> <span class="s s-Atom">version</span> <span class="s s-Atom">inferieure</span> <span class="s s-Atom">a</span> <span class="mf">1.1.14</span> <span class="s s-Atom">en</span> <span class="s s-Atom">ajoutant</span> <span class="s s-Atom">qqc</span> <span class="s s-Atom">a</span> <span class="s s-Atom">la</span> <span class="nf">fin</span>
<span class="p">(</span><span class="mi">06</span><span class="s s-Atom">:</span><span class="mi">05</span><span class="s s-Atom">:</span><span class="mi">53</span> <span class="nv">PM</span><span class="p">)</span> <span class="nn">dachary</span><span class="p">:</span> <span class="s s-Atom">pour</span> <span class="s s-Atom">moi</span> <span class="s s-Atom">ca</span> <span class="s s-Atom">va</span> <span class="s s-Atom">toujours</span> <span class="s s-Atom">etre</span> <span class="nf">superieur</span>
<span class="p">(</span><span class="mi">06</span><span class="s s-Atom">:</span><span class="mi">06</span><span class="s s-Atom">:</span><span class="mi">05</span> <span class="nv">PM</span><span class="p">)</span> <span class="nn">dachary</span><span class="p">:</span> <span class="s s-Atom">doit</span> <span class="s s-Atom">y</span> <span class="s s-Atom">avoir</span> <span class="s s-Atom">un</span> <span class="nf">truc</span>
<span class="p">(</span><span class="mi">06</span><span class="s s-Atom">:</span><span class="mi">06</span><span class="s s-Atom">:</span><span class="mi">38</span> <span class="nv">PM</span><span class="p">)</span> <span class="s s-Atom">yoda1410:</span> <span class="s s-Atom">le</span> <span class="o">-</span><span class="mi">1</span> <span class="s s-Atom">c&#39;est la revision du package</span>
<span class="s s-Atom">(06:06:43 PM) yoda1410: pas la version du package</span>
<span class="s s-Atom">(06:07:53 PM) dachary: yoda1410: oui. 7:1.1.14-1 c&#39;est</span> <span class="p">[</span><span class="nn">epoch</span><span class="p">:]</span><span class="s s-Atom">version</span><span class="p">[</span><span class="o">-</span><span class="s s-Atom">debianversion</span><span class="p">]</span>
<span class="p">(</span><span class="mi">06</span><span class="s s-Atom">:</span><span class="mi">08</span><span class="s s-Atom">:</span><span class="mi">06</span> <span class="nv">PM</span><span class="p">)</span> <span class="s s-Atom">yoda1410:</span> <span class="s s-Atom">eh</span> <span class="s s-Atom">bien</span> <span class="s s-Atom">ou</span> <span class="s s-Atom">est</span> <span class="s s-Atom">le</span> <span class="s s-Atom">soucis</span> <span class="s s-Atom">?</span>
<span class="p">(</span><span class="mi">06</span><span class="s s-Atom">:</span><span class="mi">08</span><span class="s s-Atom">:</span><span class="mi">16</span> <span class="nv">PM</span><span class="p">)</span> <span class="s s-Atom">yoda1410:</span> <span class="mf">1.1.13</span><span class="o">-</span><span class="mi">7</span> <span class="s s-Atom">seras</span> <span class="s s-Atom">toujours</span> <span class="s s-Atom">inferieur</span> <span class="s s-Atom">a</span> <span class="mf">1.1.14</span><span class="o">-</span><span class="mi">1</span>
<span class="p">(</span><span class="mi">06</span><span class="s s-Atom">:</span><span class="mi">08</span><span class="s s-Atom">:</span><span class="mi">17</span> <span class="nv">PM</span><span class="p">)</span> <span class="nn">dachary</span><span class="p">:</span> <span class="s s-Atom">si</span> <span class="s s-Atom">tu</span> <span class="s s-Atom">as</span> <span class="mi">7</span><span class="s s-Atom">:</span><span class="mf">1.1.14</span><span class="s s-Atom">~svn200</span><span class="o">-</span><span class="mi">1</span> <span class="s s-Atom">pendant</span> <span class="s s-Atom">le</span> <span class="nf">dev</span>
<span class="p">(</span><span class="mi">06</span><span class="s s-Atom">:</span><span class="mi">08</span><span class="s s-Atom">:</span><span class="mi">30</span> <span class="nv">PM</span><span class="p">)</span> <span class="nn">guillaumeb</span><span class="p">:</span> <span class="s s-Atom">yoda1410:</span> <span class="s s-Atom">oui</span><span class="p">,</span> <span class="s s-Atom">mais</span> <span class="s s-Atom">ça</span> <span class="s s-Atom">fait</span> <span class="s s-Atom">partie</span> <span class="s s-Atom">du</span> <span class="s s-Atom">numéro</span> <span class="s s-Atom">de</span> <span class="s s-Atom">version</span> <span class="s s-Atom">du</span> <span class="nf">paquet</span>
<span class="p">(</span><span class="mi">06</span><span class="s s-Atom">:</span><span class="mi">08</span><span class="s s-Atom">:</span><span class="mi">37</span> <span class="nv">PM</span><span class="p">)</span> <span class="nn">dachary</span><span class="p">:</span> <span class="s s-Atom">yoda1410:</span> <span class="s s-Atom">ah</span> <span class="p">!</span>
<span class="p">(</span><span class="mi">06</span><span class="s s-Atom">:</span><span class="mi">08</span><span class="s s-Atom">:</span><span class="mi">50</span> <span class="nv">PM</span><span class="p">)</span> <span class="nn">dachary</span><span class="p">:</span> <span class="s s-Atom">yoda1410:</span> <span class="s s-Atom">c&#39;est pas bete ce que tu dis :-)</span>
<span class="s s-Atom">(06:09:05 PM) dachary: la version release est *inferieure* a la version de dev</span>
<span class="s s-Atom">(06:09:12 PM) dachary: mais superieure a la precedente release</span>
<span class="s s-Atom">(06:09:26 PM) dachary: donc qqn qui aurait une version de dev serait dans la mouise</span>
<span class="s s-Atom">(06:09:39 PM) dachary: mais qqn qui aurait une version stable a upgrade serait bon</span>
<span class="s s-Atom">(06:10:04 PM) dachary: dans la mouise =&gt; a devoir downgrader (du point de vue de dpkg --compare-version )</span>
<span class="s s-Atom">(06:10:13 PM) yoda1410: un repository de dev, un repository stable</span>
<span class="s s-Atom">(06:10:26 PM) yoda1410: potentiellement, tu passes pas vraiment de l&#39;un</span> <span class="s s-Atom">a</span> <span class="s s-Atom">l</span><span class="err">&#39;</span><span class="s s-Atom">autre</span> <span class="s s-Atom">et</span> <span class="s s-Atom">vice</span> <span class="nf">versa</span>
<span class="p">(</span><span class="mi">06</span><span class="s s-Atom">:</span><span class="mi">10</span><span class="s s-Atom">:</span><span class="mi">57</span> <span class="nv">PM</span><span class="p">)</span> <span class="nn">dachary</span><span class="p">:</span> <span class="s s-Atom">si</span> <span class="s s-Atom">cette</span> <span class="s s-Atom">incohérence</span> <span class="s s-Atom">dans</span> <span class="s s-Atom">le</span> <span class="s s-Atom">numérotage</span> <span class="s s-Atom">des</span> <span class="s s-Atom">version</span> <span class="s s-Atom">est</span> <span class="s s-Atom">admise</span> <span class="s s-Atom">et</span> <span class="s s-Atom">habituelle</span><span class="p">,</span> <span class="s s-Atom">alors</span> <span class="s s-Atom">pourquoi</span> <span class="s s-Atom">pas</span>
<span class="mi">09</span><span class="s s-Atom">:</span><span class="mi">07</span><span class="s s-Atom">:</span><span class="mi">20</span> <span class="nv">AM</span><span class="p">)</span> <span class="nn">guillaumeb</span><span class="p">:</span> <span class="s s-Atom">comme</span> <span class="s s-Atom">disait</span> <span class="s s-Atom">yoda1410</span> <span class="s s-Atom">hier</span><span class="p">,</span> <span class="s s-Atom">on</span> <span class="s s-Atom">ne</span> <span class="s s-Atom">mélange</span> <span class="s s-Atom">pas</span> <span class="s s-Atom">les</span> <span class="mi">2</span> <span class="p">(</span><span class="s s-Atom">soit</span> <span class="s s-Atom">on</span> <span class="s s-Atom">installe</span> <span class="s s-Atom">une</span> <span class="s s-Atom">stable</span><span class="p">,</span> <span class="s s-Atom">soit</span> <span class="s s-Atom">une</span> <span class="s s-Atom">dev</span><span class="p">),</span> <span class="s s-Atom">donc</span> <span class="s s-Atom">ça</span> <span class="s s-Atom">ne</span> <span class="s s-Atom">pose</span> <span class="s s-Atom">pas</span> <span class="s s-Atom">vraiment</span> <span class="s s-Atom">de</span> <span class="nf">pb</span>
<span class="p">(</span><span class="mi">09</span><span class="s s-Atom">:</span><span class="mi">08</span><span class="s s-Atom">:</span><span class="mi">45</span> <span class="nv">AM</span><span class="p">)</span> <span class="nn">dachary</span><span class="p">:</span> <span class="nn">guillaumeb</span><span class="p">:</span> <span class="s s-Atom">ok</span><span class="p">,</span> <span class="s s-Atom">donc</span> <span class="s s-Atom">je</span> <span class="s s-Atom">vais</span> <span class="s s-Atom">implémenter</span> <span class="s s-Atom">un</span> <span class="s s-Atom">truc</span> <span class="s s-Atom">qui</span> <span class="s s-Atom">permet</span> <span class="s s-Atom">de</span> <span class="s s-Atom">supprimer</span> <span class="s s-Atom">la</span> <span class="s s-Atom">génération</span> <span class="s s-Atom">de</span> <span class="s s-Atom">timestamp</span> <span class="o">+</span> <span class="s s-Atom">hash</span> <span class="s s-Atom">après</span> <span class="s s-Atom">~</span> <span class="s s-Atom">et</span> <span class="s s-Atom">ce</span> <span class="s s-Atom">flag</span> <span class="s s-Atom">pourra</span> <span class="s s-Atom">etre</span> <span class="s s-Atom">mis</span> <span class="s s-Atom">sur</span> <span class="s s-Atom">la</span> <span class="s s-Atom">machine</span> <span class="s s-Atom">de</span> <span class="s s-Atom">build</span> <span class="s s-Atom">qui</span> <span class="s s-Atom">se</span> <span class="s s-Atom">charge</span> <span class="s s-Atom">des</span> <span class="s s-Atom">release</span><span class="p">.</span> <span class="nv">Ca</span> <span class="s s-Atom">ira</span> <span class="s s-Atom">comme</span> <span class="s s-Atom">ça</span> <span class="s s-Atom">tu</span> <span class="s s-Atom">penses</span> <span class="s s-Atom">?</span> 
<span class="p">(</span><span class="mi">09</span><span class="s s-Atom">:</span><span class="mi">09</span><span class="s s-Atom">:</span><span class="mi">15</span> <span class="nv">AM</span><span class="p">)</span> <span class="nn">dachary</span><span class="p">:</span> <span class="s s-Atom">je</span> <span class="s s-Atom">peux</span> <span class="s s-Atom">faire</span> <span class="s s-Atom">ça</span> <span class="s s-Atom">lundi</span><span class="p">.</span>
</pre></div>


<p><a href="http://packaging-farm.dachary.org/trac/changeset/da84c60ee1a61fdf728720ba71fb99cdb8e9897f">VERSION_COMPUTE is
implemented</a>
to disable the use of a timestamp and short hash when generating the
source version number in submit-xivo.sh. The goal of this variable is to
shorten the XiVO version numbers for production packages, meaning the
development packages will have a lower version number than the
development packages.The manual page was updated with the new option:</p>
<div class="highlight"><pre><span></span>VERSION_COMPUTE=true
              By default each source version number is  created  by  computing
              the  current  time  and extracting the last commit hash from the
              source repository  (see  the  VERSION  section  above.  If  VER-
              SION_COMPUTE is set to false then the current time and last com-
              mit hash are not used when generating the version number.
</pre></div>


<h4>epoch change</h4>
<p>The version 2.0.12 of packaging-farm was installed on the gallifrey
virtual machine instead of the previous 2.0.10 that did not contain the
package version safeguards. When running</p>
<div class="highlight"><pre><span></span>packaging-farm --cd gallifrey update
</pre></div>


<p>The following errors are reported :</p>
<div class="highlight"><pre><span></span><span class="nt">The</span> <span class="nt">first</span> <span class="nt">line</span> <span class="nt">of</span> <span class="o">/</span><span class="nt">var</span><span class="o">/</span><span class="nt">cache</span><span class="o">/</span><span class="nt">packaging-farm</span><span class="o">/</span><span class="nt">VCS</span><span class="o">/</span><span class="nt">debian</span><span class="o">/</span><span class="nt">lenny-xivo-gallifrey</span><span class="o">/</span><span class="nt">asterisk-chan-sccp</span><span class="o">/</span><span class="nt">trunk</span><span class="o">/</span><span class="nt">debian</span><span class="o">/</span><span class="nt">changelog</span> <span class="nt">is</span> <span class="s1">&#39;asterisk-chan-sccp (3:0~prerelease+svn2187+pf.xivo.1.1.16~svn11148-6) lenny-xivo-gallifrey-dev; urgency=low&#39;</span> <span class="nt">and</span> <span class="nt">contains</span> <span class="nt">a</span> <span class="nt">version</span> <span class="o">(</span><span class="nt">3</span><span class="nd">:0</span><span class="o">~</span><span class="nt">prerelease</span><span class="o">+</span><span class="nt">svn2187</span><span class="o">+</span><span class="nt">pf</span><span class="nc">.xivo.1.1.16</span><span class="o">~</span><span class="nt">svn11148-6</span><span class="o">)</span> <span class="nt">that</span> <span class="nt">is</span> <span class="nt">greater</span> <span class="nt">or</span> <span class="nt">equal</span> <span class="o">(</span><span class="nt">according</span> <span class="nt">to</span> <span class="nt">dpkg</span> <span class="nt">--compare-versions</span><span class="o">)</span> <span class="nt">than</span> <span class="nt">the</span> <span class="nt">version</span> <span class="nt">computed</span> <span class="nt">by</span> <span class="nt">submit-xivo</span><span class="nc">.sh</span> <span class="o">(</span><span class="nt">3</span><span class="nd">:0</span><span class="o">~</span><span class="nt">prerelease</span><span class="o">+</span><span class="nt">svn2187</span><span class="o">+</span><span class="nt">pf</span><span class="nc">.xivo.1.1.16</span><span class="o">~</span><span class="nt">20110628</span><span class="nc">.185034.ab4fbbe-1</span><span class="o">)</span>
<span class="nt">The</span> <span class="nt">first</span> <span class="nt">line</span> <span class="nt">of</span> <span class="o">/</span><span class="nt">var</span><span class="o">/</span><span class="nt">cache</span><span class="o">/</span><span class="nt">packaging-farm</span><span class="o">/</span><span class="nt">VCS</span><span class="o">/</span><span class="nt">debian</span><span class="o">/</span><span class="nt">lenny-xivo-gallifrey</span><span class="o">/</span><span class="nt">dahdi-tools</span><span class="o">/</span><span class="nt">trunk</span><span class="o">/</span><span class="nt">debian</span><span class="o">/</span><span class="nt">changelog</span> <span class="nt">is</span> <span class="s1">&#39;dahdi-tools (12:2.4.1+pf.xivo.1.1.16~svn10418-1) lenny-xivo-gallifrey-dev; urgency=low&#39;</span> <span class="nt">and</span> <span class="nt">contains</span> <span class="nt">a</span> <span class="nt">version</span> <span class="o">(</span><span class="nt">12</span><span class="nd">:2</span><span class="nc">.4.1</span><span class="o">+</span><span class="nt">pf</span><span class="nc">.xivo.1.1.16</span><span class="o">~</span><span class="nt">svn10418-1</span><span class="o">)</span> <span class="nt">that</span> <span class="nt">is</span> <span class="nt">greater</span> <span class="nt">or</span> <span class="nt">equal</span> <span class="o">(</span><span class="nt">according</span> <span class="nt">to</span> <span class="nt">dpkg</span> <span class="nt">--compare-versions</span><span class="o">)</span> <span class="nt">than</span> <span class="nt">the</span> <span class="nt">version</span> <span class="nt">computed</span> <span class="nt">by</span> <span class="nt">submit-xivo</span><span class="nc">.sh</span> <span class="o">(</span><span class="nt">12</span><span class="nd">:2</span><span class="nc">.4.1</span><span class="o">+</span><span class="nt">pf</span><span class="nc">.xivo.1.1.16</span><span class="o">~</span><span class="nt">20110323</span><span class="nc">.135020.382fcea-1</span><span class="o">)</span>
<span class="nt">The</span> <span class="nt">first</span> <span class="nt">line</span> <span class="nt">of</span> <span class="o">/</span><span class="nt">var</span><span class="o">/</span><span class="nt">cache</span><span class="o">/</span><span class="nt">packaging-farm</span><span class="o">/</span><span class="nt">VCS</span><span class="o">/</span><span class="nt">debian</span><span class="o">/</span><span class="nt">lenny-xivo-gallifrey</span><span class="o">/</span><span class="nt">asterisk-sounds-gsm-de-de</span><span class="o">/</span><span class="nt">trunk</span><span class="o">/</span><span class="nt">debian</span><span class="o">/</span><span class="nt">changelog</span> <span class="nt">is</span> <span class="s1">&#39;asterisk-sounds-gsm-de-de (1.0+pf.xivo.1.1.16~svn8396-1) lenny-xivo-gallifrey-dev; urgency=low&#39;</span> <span class="nt">and</span> <span class="nt">contains</span> <span class="nt">a</span> <span class="nt">version</span> <span class="o">(</span><span class="nt">1</span><span class="nc">.0</span><span class="o">+</span><span class="nt">pf</span><span class="nc">.xivo.1.1.16</span><span class="o">~</span><span class="nt">svn8396-1</span><span class="o">)</span> <span class="nt">that</span> <span class="nt">is</span> <span class="nt">greater</span> <span class="nt">or</span> <span class="nt">equal</span> <span class="o">(</span><span class="nt">according</span> <span class="nt">to</span> <span class="nt">dpkg</span> <span class="nt">--compare-versions</span><span class="o">)</span> <span class="nt">than</span> <span class="nt">the</span> <span class="nt">version</span> <span class="nt">computed</span> <span class="nt">by</span> <span class="nt">submit-xivo</span><span class="nc">.sh</span> <span class="o">(</span><span class="nt">1</span><span class="nc">.0</span><span class="o">+</span><span class="nt">pf</span><span class="nc">.xivo.1.1.16</span><span class="o">~</span><span class="nt">20100617</span><span class="nc">.101945.9e0ba42-1</span><span class="o">)</span>
<span class="nt">The</span> <span class="nt">first</span> <span class="nt">line</span> <span class="nt">of</span> <span class="o">/</span><span class="nt">var</span><span class="o">/</span><span class="nt">cache</span><span class="o">/</span><span class="nt">packaging-farm</span><span class="o">/</span><span class="nt">VCS</span><span class="o">/</span><span class="nt">debian</span><span class="o">/</span><span class="nt">lenny-xivo-gallifrey</span><span class="o">/</span><span class="nt">asterisk-sounds-wav-en-us</span><span class="o">/</span><span class="nt">trunk</span><span class="o">/</span><span class="nt">debian</span><span class="o">/</span><span class="nt">changelog</span> <span class="nt">is</span> <span class="s1">&#39;asterisk-sounds-wav-en-us (1:1.4.19+pf.xivo.1.1.16~svn8366-1) lenny-xivo-gallifrey-dev; urgency=low&#39;</span> <span class="nt">and</span> <span class="nt">contains</span> <span class="nt">a</span> <span class="nt">version</span> <span class="o">(</span><span class="nt">1</span><span class="nd">:1</span><span class="nc">.4.19</span><span class="o">+</span><span class="nt">pf</span><span class="nc">.xivo.1.1.16</span><span class="o">~</span><span class="nt">svn8366-1</span><span class="o">)</span> <span class="nt">that</span> <span class="nt">is</span> <span class="nt">greater</span> <span class="nt">or</span> <span class="nt">equal</span> <span class="o">(</span><span class="nt">according</span> <span class="nt">to</span> <span class="nt">dpkg</span> <span class="nt">--compare-versions</span><span class="o">)</span> <span class="nt">than</span> <span class="nt">the</span> <span class="nt">version</span> <span class="nt">computed</span> <span class="nt">by</span> <span class="nt">submit-xivo</span><span class="nc">.sh</span> <span class="o">(</span><span class="nt">1</span><span class="nd">:1</span><span class="nc">.4.19</span><span class="o">+</span><span class="nt">pf</span><span class="nc">.xivo.1.1.16</span><span class="o">~</span><span class="nt">20100615</span><span class="nc">.100833.e35f5bc-1</span><span class="o">)</span>
<span class="nt">The</span> <span class="nt">first</span> <span class="nt">line</span> <span class="nt">of</span> <span class="o">/</span><span class="nt">var</span><span class="o">/</span><span class="nt">cache</span><span class="o">/</span><span class="nt">packaging-farm</span><span class="o">/</span><span class="nt">VCS</span><span class="o">/</span><span class="nt">debian</span><span class="o">/</span><span class="nt">lenny-xivo-gallifrey</span><span class="o">/</span><span class="nt">asterisk-sounds-wav-es-es</span><span class="o">/</span><span class="nt">trunk</span><span class="o">/</span><span class="nt">debian</span><span class="o">/</span><span class="nt">changelog</span> <span class="nt">is</span> <span class="s1">&#39;asterisk-sounds-wav-es-es (1.4.19+pf.xivo.1.1.16~svn8369-1) lenny-xivo-gallifrey-dev; urgency=low&#39;</span> <span class="nt">and</span> <span class="nt">contains</span> <span class="nt">a</span> <span class="nt">version</span> <span class="o">(</span><span class="nt">1</span><span class="nc">.4.19</span><span class="o">+</span><span class="nt">pf</span><span class="nc">.xivo.1.1.16</span><span class="o">~</span><span class="nt">svn8369-1</span><span class="o">)</span> <span class="nt">that</span> <span class="nt">is</span> <span class="nt">greater</span> <span class="nt">or</span> <span class="nt">equal</span> <span class="o">(</span><span class="nt">according</span> <span class="nt">to</span> <span class="nt">dpkg</span> <span class="nt">--compare-versions</span><span class="o">)</span> <span class="nt">than</span> <span class="nt">the</span> <span class="nt">version</span> <span class="nt">computed</span> <span class="nt">by</span> <span class="nt">submit-xivo</span><span class="nc">.sh</span> <span class="o">(</span><span class="nt">1</span><span class="nc">.4.19</span><span class="o">+</span><span class="nt">pf</span><span class="nc">.xivo.1.1.16</span><span class="o">~</span><span class="nt">20100615</span><span class="nc">.123951.a72913e-1</span><span class="o">)</span>
<span class="nt">The</span> <span class="nt">first</span> <span class="nt">line</span> <span class="nt">of</span> <span class="o">/</span><span class="nt">var</span><span class="o">/</span><span class="nt">cache</span><span class="o">/</span><span class="nt">packaging-farm</span><span class="o">/</span><span class="nt">VCS</span><span class="o">/</span><span class="nt">debian</span><span class="o">/</span><span class="nt">lenny-xivo-gallifrey</span><span class="o">/</span><span class="nt">asterisk-sounds-wav-fr-ca</span><span class="o">/</span><span class="nt">trunk</span><span class="o">/</span><span class="nt">debian</span><span class="o">/</span><span class="nt">changelog</span> <span class="nt">is</span> <span class="s1">&#39;asterisk-sounds-wav-fr-ca (1.4.19+pf.xivo.1.1.16~svn8373-1) lenny-xivo-gallifrey-dev; urgency=low&#39;</span> <span class="nt">and</span> <span class="nt">contains</span> <span class="nt">a</span> <span class="nt">version</span> <span class="o">(</span><span class="nt">1</span><span class="nc">.4.19</span><span class="o">+</span><span class="nt">pf</span><span class="nc">.xivo.1.1.16</span><span class="o">~</span><span class="nt">svn8373-1</span><span class="o">)</span> <span class="nt">that</span> <span class="nt">is</span> <span class="nt">greater</span> <span class="nt">or</span> <span class="nt">equal</span> <span class="o">(</span><span class="nt">according</span> <span class="nt">to</span> <span class="nt">dpkg</span> <span class="nt">--compare-versions</span><span class="o">)</span> <span class="nt">than</span> <span class="nt">the</span> <span class="nt">version</span> <span class="nt">computed</span> <span class="nt">by</span> <span class="nt">submit-xivo</span><span class="nc">.sh</span> <span class="o">(</span><span class="nt">1</span><span class="nc">.4.19</span><span class="o">+</span><span class="nt">pf</span><span class="nc">.xivo.1.1.16</span><span class="o">~</span><span class="nt">20100615</span><span class="nc">.131728.8e37c34-1</span><span class="o">)</span>
<span class="nt">The</span> <span class="nt">first</span> <span class="nt">line</span> <span class="nt">of</span> <span class="o">/</span><span class="nt">var</span><span class="o">/</span><span class="nt">cache</span><span class="o">/</span><span class="nt">packaging-farm</span><span class="o">/</span><span class="nt">VCS</span><span class="o">/</span><span class="nt">debian</span><span class="o">/</span><span class="nt">lenny-xivo-gallifrey</span><span class="o">/</span><span class="nt">pf-asterisk-prompts-xivo</span><span class="o">/</span><span class="nt">trunk</span><span class="o">/</span><span class="nt">debian</span><span class="o">/</span><span class="nt">changelog</span> <span class="nt">is</span> <span class="s1">&#39;pf-asterisk-prompts-xivo (1.1.16~svn10712-1) lenny-xivo-gallifrey-dev; urgency=low&#39;</span> <span class="nt">and</span> <span class="nt">contains</span> <span class="nt">a</span> <span class="nt">version</span> <span class="o">(</span><span class="nt">1</span><span class="nc">.1.16</span><span class="o">~</span><span class="nt">svn10712-1</span><span class="o">)</span> <span class="nt">that</span> <span class="nt">is</span> <span class="nt">greater</span> <span class="nt">or</span> <span class="nt">equal</span> <span class="o">(</span><span class="nt">according</span> <span class="nt">to</span> <span class="nt">dpkg</span> <span class="nt">--compare-versions</span><span class="o">)</span> <span class="nt">than</span> <span class="nt">the</span> <span class="nt">version</span> <span class="nt">computed</span> <span class="nt">by</span> <span class="nt">submit-xivo</span><span class="nc">.sh</span> <span class="o">(</span><span class="nt">1</span><span class="nc">.1.16</span><span class="o">~</span><span class="nt">20110505</span><span class="nc">.071312.f112dde-1</span><span class="o">)</span>
<span class="nt">The</span> <span class="nt">first</span> <span class="nt">line</span> <span class="nt">of</span> <span class="o">/</span><span class="nt">var</span><span class="o">/</span><span class="nt">cache</span><span class="o">/</span><span class="nt">packaging-farm</span><span class="o">/</span><span class="nt">VCS</span><span class="o">/</span><span class="nt">debian</span><span class="o">/</span><span class="nt">lenny-xivo-gallifrey</span><span class="o">/</span><span class="nt">pf-asterisk-prompts</span><span class="o">/</span><span class="nt">trunk</span><span class="o">/</span><span class="nt">debian</span><span class="o">/</span><span class="nt">changelog</span> <span class="nt">is</span> <span class="s1">&#39;pf-asterisk-prompts (2:1.1.16~svn10715-2) lenny-xivo-gallifrey-dev; urgency=low&#39;</span> <span class="nt">and</span> <span class="nt">contains</span> <span class="nt">a</span> <span class="nt">version</span> <span class="o">(</span><span class="nt">2</span><span class="nd">:1</span><span class="nc">.1.16</span><span class="o">~</span><span class="nt">svn10715-2</span><span class="o">)</span> <span class="nt">that</span> <span class="nt">is</span> <span class="nt">greater</span> <span class="nt">or</span> <span class="nt">equal</span> <span class="o">(</span><span class="nt">according</span> <span class="nt">to</span> <span class="nt">dpkg</span> <span class="nt">--compare-versions</span><span class="o">)</span> <span class="nt">than</span> <span class="nt">the</span> <span class="nt">version</span> <span class="nt">computed</span> <span class="nt">by</span> <span class="nt">submit-xivo</span><span class="nc">.sh</span> <span class="o">(</span><span class="nt">2</span><span class="nd">:1</span><span class="nc">.1.16</span><span class="o">~</span><span class="nt">20110505</span><span class="nc">.073011.01bf04f-1</span><span class="o">)</span>
<span class="nt">The</span> <span class="nt">first</span> <span class="nt">line</span> <span class="nt">of</span> <span class="o">/</span><span class="nt">var</span><span class="o">/</span><span class="nt">cache</span><span class="o">/</span><span class="nt">packaging-farm</span><span class="o">/</span><span class="nt">VCS</span><span class="o">/</span><span class="nt">debian</span><span class="o">/</span><span class="nt">lenny-xivo-gallifrey</span><span class="o">/</span><span class="nt">pf-asternic-stats</span><span class="o">/</span><span class="nt">trunk</span><span class="o">/</span><span class="nt">debian</span><span class="o">/</span><span class="nt">changelog</span> <span class="nt">is</span> <span class="s1">&#39;pf-asternic-stats (3:1.1.16~svn9393-1) lenny-xivo-gallifrey-dev; urgency=low&#39;</span> <span class="nt">and</span> <span class="nt">contains</span> <span class="nt">a</span> <span class="nt">version</span> <span class="o">(</span><span class="nt">3</span><span class="nd">:1</span><span class="nc">.1.16</span><span class="o">~</span><span class="nt">svn9393-1</span><span class="o">)</span> <span class="nt">that</span> <span class="nt">is</span> <span class="nt">greater</span> <span class="nt">or</span> <span class="nt">equal</span> <span class="o">(</span><span class="nt">according</span> <span class="nt">to</span> <span class="nt">dpkg</span> <span class="nt">--compare-versions</span><span class="o">)</span> <span class="nt">than</span> <span class="nt">the</span> <span class="nt">version</span> <span class="nt">computed</span> <span class="nt">by</span> <span class="nt">submit-xivo</span><span class="nc">.sh</span> <span class="o">(</span><span class="nt">3</span><span class="nd">:1</span><span class="nc">.1.16</span><span class="o">~</span><span class="nt">20101008</span><span class="nc">.160607.3537a3d-1</span><span class="o">)</span>
<span class="nt">The</span> <span class="nt">first</span> <span class="nt">line</span> <span class="nt">of</span> <span class="o">/</span><span class="nt">var</span><span class="o">/</span><span class="nt">cache</span><span class="o">/</span><span class="nt">packaging-farm</span><span class="o">/</span><span class="nt">VCS</span><span class="o">/</span><span class="nt">debian</span><span class="o">/</span><span class="nt">lenny-xivo-gallifrey</span><span class="o">/</span><span class="nt">pf-xivo-agid</span><span class="o">/</span><span class="nt">trunk</span><span class="o">/</span><span class="nt">debian</span><span class="o">/</span><span class="nt">changelog</span> <span class="nt">is</span> <span class="s1">&#39;pf-xivo-agid (6:1.1.16~svn11175-1) lenny-xivo-gallifrey-dev; urgency=low&#39;</span> <span class="nt">and</span> <span class="nt">contains</span> <span class="nt">a</span> <span class="nt">version</span> <span class="o">(</span><span class="nt">6</span><span class="nd">:1</span><span class="nc">.1.16</span><span class="o">~</span><span class="nt">svn11175-1</span><span class="o">)</span> <span class="nt">that</span> <span class="nt">is</span> <span class="nt">greater</span> <span class="nt">or</span> <span class="nt">equal</span> <span class="o">(</span><span class="nt">according</span> <span class="nt">to</span> <span class="nt">dpkg</span> <span class="nt">--compare-versions</span><span class="o">)</span> <span class="nt">than</span> <span class="nt">the</span> <span class="nt">version</span> <span class="nt">computed</span> <span class="nt">by</span> <span class="nt">submit-xivo</span><span class="nc">.sh</span> <span class="o">(</span><span class="nt">6</span><span class="nd">:1</span><span class="nc">.1.16</span><span class="o">~</span><span class="nt">20110701</span><span class="nc">.092341.397e495-1</span><span class="o">)</span>
<span class="nt">The</span> <span class="nt">first</span> <span class="nt">line</span> <span class="nt">of</span> <span class="o">/</span><span class="nt">var</span><span class="o">/</span><span class="nt">cache</span><span class="o">/</span><span class="nt">packaging-farm</span><span class="o">/</span><span class="nt">VCS</span><span class="o">/</span><span class="nt">debian</span><span class="o">/</span><span class="nt">lenny-xivo-gallifrey</span><span class="o">/</span><span class="nt">pf-xivo-base-config</span><span class="o">/</span><span class="nt">trunk</span><span class="o">/</span><span class="nt">debian</span><span class="o">/</span><span class="nt">changelog</span> <span class="nt">is</span> <span class="s1">&#39;pf-xivo-base-config (10:1.1.16~svn11120-1) lenny-xivo-gallifrey-dev; urgency=low&#39;</span> <span class="nt">and</span> <span class="nt">contains</span> <span class="nt">a</span> <span class="nt">version</span> <span class="o">(</span><span class="nt">10</span><span class="nd">:1</span><span class="nc">.1.16</span><span class="o">~</span><span class="nt">svn11120-1</span><span class="o">)</span> <span class="nt">that</span> <span class="nt">is</span> <span class="nt">greater</span> <span class="nt">or</span> <span class="nt">equal</span> <span class="o">(</span><span class="nt">according</span> <span class="nt">to</span> <span class="nt">dpkg</span> <span class="nt">--compare-versions</span><span class="o">)</span> <span class="nt">than</span> <span class="nt">the</span> <span class="nt">version</span> <span class="nt">computed</span> <span class="nt">by</span> <span class="nt">submit-xivo</span><span class="nc">.sh</span> <span class="o">(</span><span class="nt">10</span><span class="nd">:1</span><span class="nc">.1.16</span><span class="o">~</span><span class="nt">20110802</span><span class="nc">.135651.7f1de42-1</span><span class="o">)</span>
<span class="nt">The</span> <span class="nt">first</span> <span class="nt">line</span> <span class="nt">of</span> <span class="o">/</span><span class="nt">var</span><span class="o">/</span><span class="nt">cache</span><span class="o">/</span><span class="nt">packaging-farm</span><span class="o">/</span><span class="nt">VCS</span><span class="o">/</span><span class="nt">debian</span><span class="o">/</span><span class="nt">lenny-xivo-gallifrey</span><span class="o">/</span><span class="nt">pf-xivo-cti-server</span><span class="o">/</span><span class="nt">trunk</span><span class="o">/</span><span class="nt">debian</span><span class="o">/</span><span class="nt">changelog</span> <span class="nt">is</span> <span class="s1">&#39;pf-xivo-cti-server (26:1.1.16~svn10937-1) lenny-xivo-gallifrey-dev; urgency=low&#39;</span> <span class="nt">and</span> <span class="nt">contains</span> <span class="nt">a</span> <span class="nt">version</span> <span class="o">(</span><span class="nt">26</span><span class="nd">:1</span><span class="nc">.1.16</span><span class="o">~</span><span class="nt">svn10937-1</span><span class="o">)</span> <span class="nt">that</span> <span class="nt">is</span> <span class="nt">greater</span> <span class="nt">or</span> <span class="nt">equal</span> <span class="o">(</span><span class="nt">according</span> <span class="nt">to</span> <span class="nt">dpkg</span> <span class="nt">--compare-versions</span><span class="o">)</span> <span class="nt">than</span> <span class="nt">the</span> <span class="nt">version</span> <span class="nt">computed</span> <span class="nt">by</span> <span class="nt">submit-xivo</span><span class="nc">.sh</span> <span class="o">(</span><span class="nt">26</span><span class="nd">:1</span><span class="nc">.1.16</span><span class="o">~</span><span class="nt">20110727</span><span class="nc">.102922.01b04e7-1</span><span class="o">)</span>
<span class="nt">The</span> <span class="nt">first</span> <span class="nt">line</span> <span class="nt">of</span> <span class="o">/</span><span class="nt">var</span><span class="o">/</span><span class="nt">cache</span><span class="o">/</span><span class="nt">packaging-farm</span><span class="o">/</span><span class="nt">VCS</span><span class="o">/</span><span class="nt">debian</span><span class="o">/</span><span class="nt">lenny-xivo-gallifrey</span><span class="o">/</span><span class="nt">pf-xivo-cti-webclient</span><span class="o">/</span><span class="nt">trunk</span><span class="o">/</span><span class="nt">debian</span><span class="o">/</span><span class="nt">changelog</span> <span class="nt">is</span> <span class="s1">&#39;pf-xivo-cti-webclient (1:1.1.16~svn9668-1) etch-xivo-dalek-dev; urgency=low&#39;</span> <span class="nt">and</span> <span class="nt">contains</span> <span class="nt">a</span> <span class="nt">version</span> <span class="o">(</span><span class="nt">1</span><span class="nd">:1</span><span class="nc">.1.16</span><span class="o">~</span><span class="nt">svn9668-1</span><span class="o">)</span> <span class="nt">that</span> <span class="nt">is</span> <span class="nt">greater</span> <span class="nt">or</span> <span class="nt">equal</span> <span class="o">(</span><span class="nt">according</span> <span class="nt">to</span> <span class="nt">dpkg</span> <span class="nt">--compare-versions</span><span class="o">)</span> <span class="nt">than</span> <span class="nt">the</span> <span class="nt">version</span> <span class="nt">computed</span> <span class="nt">by</span> <span class="nt">submit-xivo</span><span class="nc">.sh</span> <span class="o">(</span><span class="nt">1</span><span class="nd">:1</span><span class="nc">.1.16</span><span class="o">~</span><span class="nt">20101130</span><span class="nc">.153620.4f95789-1</span><span class="o">)</span>
<span class="nt">The</span> <span class="nt">first</span> <span class="nt">line</span> <span class="nt">of</span> <span class="o">/</span><span class="nt">var</span><span class="o">/</span><span class="nt">cache</span><span class="o">/</span><span class="nt">packaging-farm</span><span class="o">/</span><span class="nt">VCS</span><span class="o">/</span><span class="nt">debian</span><span class="o">/</span><span class="nt">lenny-xivo-gallifrey</span><span class="o">/</span><span class="nt">pf-xivo-extra</span><span class="o">/</span><span class="nt">trunk</span><span class="o">/</span><span class="nt">debian</span><span class="o">/</span><span class="nt">changelog</span> <span class="nt">is</span> <span class="s1">&#39;pf-xivo-extra (1.1.16~svn9928-1) lenny-xivo-gallifrey; urgency=low&#39;</span> <span class="nt">and</span> <span class="nt">contains</span> <span class="nt">a</span> <span class="nt">version</span> <span class="o">(</span><span class="nt">1</span><span class="nc">.1.16</span><span class="o">~</span><span class="nt">svn9928-1</span><span class="o">)</span> <span class="nt">that</span> <span class="nt">is</span> <span class="nt">greater</span> <span class="nt">or</span> <span class="nt">equal</span> <span class="o">(</span><span class="nt">according</span> <span class="nt">to</span> <span class="nt">dpkg</span> <span class="nt">--compare-versions</span><span class="o">)</span> <span class="nt">than</span> <span class="nt">the</span> <span class="nt">version</span> <span class="nt">computed</span> <span class="nt">by</span> <span class="nt">submit-xivo</span><span class="nc">.sh</span> <span class="o">(</span><span class="nt">1</span><span class="nc">.1.16</span><span class="o">~</span><span class="nt">20110112</span><span class="nc">.094154.13f90a7-1</span><span class="o">)</span>
<span class="nt">The</span> <span class="nt">first</span> <span class="nt">line</span> <span class="nt">of</span> <span class="o">/</span><span class="nt">var</span><span class="o">/</span><span class="nt">cache</span><span class="o">/</span><span class="nt">packaging-farm</span><span class="o">/</span><span class="nt">VCS</span><span class="o">/</span><span class="nt">debian</span><span class="o">/</span><span class="nt">lenny-xivo-gallifrey</span><span class="o">/</span><span class="nt">pf-xivo-fetchfw</span><span class="o">/</span><span class="nt">trunk</span><span class="o">/</span><span class="nt">debian</span><span class="o">/</span><span class="nt">changelog</span> <span class="nt">is</span> <span class="s1">&#39;pf-xivo-fetchfw (3:1.1.16~svn11130-1) etch-xivo-gallifrey-dev; urgency=low&#39;</span> <span class="nt">and</span> <span class="nt">contains</span> <span class="nt">a</span> <span class="nt">version</span> <span class="o">(</span><span class="nt">3</span><span class="nd">:1</span><span class="nc">.1.16</span><span class="o">~</span><span class="nt">svn11130-1</span><span class="o">)</span> <span class="nt">that</span> <span class="nt">is</span> <span class="nt">greater</span> <span class="nt">or</span> <span class="nt">equal</span> <span class="o">(</span><span class="nt">according</span> <span class="nt">to</span> <span class="nt">dpkg</span> <span class="nt">--compare-versions</span><span class="o">)</span> <span class="nt">than</span> <span class="nt">the</span> <span class="nt">version</span> <span class="nt">computed</span> <span class="nt">by</span> <span class="nt">submit-xivo</span><span class="nc">.sh</span> <span class="o">(</span><span class="nt">3</span><span class="nd">:1</span><span class="nc">.1.16</span><span class="o">~</span><span class="nt">20110627</span><span class="nc">.175022.83cded2-1</span><span class="o">)</span>
<span class="nt">The</span> <span class="nt">first</span> <span class="nt">line</span> <span class="nt">of</span> <span class="o">/</span><span class="nt">var</span><span class="o">/</span><span class="nt">cache</span><span class="o">/</span><span class="nt">packaging-farm</span><span class="o">/</span><span class="nt">VCS</span><span class="o">/</span><span class="nt">debian</span><span class="o">/</span><span class="nt">lenny-xivo-gallifrey</span><span class="o">/</span><span class="nt">pf-xivo-lib-python</span><span class="o">/</span><span class="nt">trunk</span><span class="o">/</span><span class="nt">debian</span><span class="o">/</span><span class="nt">changelog</span> <span class="nt">is</span> <span class="s1">&#39;pf-xivo-lib-python (19:1.1.16~svn10798-1) lenny-xivo-gallifrey-dev; urgency=low&#39;</span> <span class="nt">and</span> <span class="nt">contains</span> <span class="nt">a</span> <span class="nt">version</span> <span class="o">(</span><span class="nt">19</span><span class="nd">:1</span><span class="nc">.1.16</span><span class="o">~</span><span class="nt">svn10798-1</span><span class="o">)</span> <span class="nt">that</span> <span class="nt">is</span> <span class="nt">greater</span> <span class="nt">or</span> <span class="nt">equal</span> <span class="o">(</span><span class="nt">according</span> <span class="nt">to</span> <span class="nt">dpkg</span> <span class="nt">--compare-versions</span><span class="o">)</span> <span class="nt">than</span> <span class="nt">the</span> <span class="nt">version</span> <span class="nt">computed</span> <span class="nt">by</span> <span class="nt">submit-xivo</span><span class="nc">.sh</span> <span class="o">(</span><span class="nt">19</span><span class="nd">:1</span><span class="nc">.1.16</span><span class="o">~</span><span class="nt">20110512</span><span class="nc">.142430.c2d6027-1</span><span class="o">)</span>
<span class="nt">The</span> <span class="nt">first</span> <span class="nt">line</span> <span class="nt">of</span> <span class="o">/</span><span class="nt">var</span><span class="o">/</span><span class="nt">cache</span><span class="o">/</span><span class="nt">packaging-farm</span><span class="o">/</span><span class="nt">VCS</span><span class="o">/</span><span class="nt">debian</span><span class="o">/</span><span class="nt">lenny-xivo-gallifrey</span><span class="o">/</span><span class="nt">pf-xivo-provisioning</span><span class="o">/</span><span class="nt">trunk</span><span class="o">/</span><span class="nt">debian</span><span class="o">/</span><span class="nt">changelog</span> <span class="nt">is</span> <span class="s1">&#39;pf-xivo-provisioning (4:1.1.16~svn10454-1) lenny-xivo-gallifrey-dev; urgency=low&#39;</span> <span class="nt">and</span> <span class="nt">contains</span> <span class="nt">a</span> <span class="nt">version</span> <span class="o">(</span><span class="nt">4</span><span class="nd">:1</span><span class="nc">.1.16</span><span class="o">~</span><span class="nt">svn10454-1</span><span class="o">)</span> <span class="nt">that</span> <span class="nt">is</span> <span class="nt">greater</span> <span class="nt">or</span> <span class="nt">equal</span> <span class="o">(</span><span class="nt">according</span> <span class="nt">to</span> <span class="nt">dpkg</span> <span class="nt">--compare-versions</span><span class="o">)</span> <span class="nt">than</span> <span class="nt">the</span> <span class="nt">version</span> <span class="nt">computed</span> <span class="nt">by</span> <span class="nt">submit-xivo</span><span class="nc">.sh</span> <span class="o">(</span><span class="nt">4</span><span class="nd">:1</span><span class="nc">.1.16</span><span class="o">~</span><span class="nt">20110331</span><span class="nc">.175748.85fafed-1</span><span class="o">)</span>
<span class="nt">The</span> <span class="nt">first</span> <span class="nt">line</span> <span class="nt">of</span> <span class="o">/</span><span class="nt">var</span><span class="o">/</span><span class="nt">cache</span><span class="o">/</span><span class="nt">packaging-farm</span><span class="o">/</span><span class="nt">VCS</span><span class="o">/</span><span class="nt">debian</span><span class="o">/</span><span class="nt">lenny-xivo-gallifrey</span><span class="o">/</span><span class="nt">pf-xivo-queues-logger</span><span class="o">/</span><span class="nt">trunk</span><span class="o">/</span><span class="nt">debian</span><span class="o">/</span><span class="nt">changelog</span> <span class="nt">is</span> <span class="s1">&#39;pf-xivo-queues-logger (1:1.1.16~svn9930-1) lenny-xivo-gallifrey-dev; urgency=low&#39;</span> <span class="nt">and</span> <span class="nt">contains</span> <span class="nt">a</span> <span class="nt">version</span> <span class="o">(</span><span class="nt">1</span><span class="nd">:1</span><span class="nc">.1.16</span><span class="o">~</span><span class="nt">svn9930-1</span><span class="o">)</span> <span class="nt">that</span> <span class="nt">is</span> <span class="nt">greater</span> <span class="nt">or</span> <span class="nt">equal</span> <span class="o">(</span><span class="nt">according</span> <span class="nt">to</span> <span class="nt">dpkg</span> <span class="nt">--compare-versions</span><span class="o">)</span> <span class="nt">than</span> <span class="nt">the</span> <span class="nt">version</span> <span class="nt">computed</span> <span class="nt">by</span> <span class="nt">submit-xivo</span><span class="nc">.sh</span> <span class="o">(</span><span class="nt">1</span><span class="nd">:1</span><span class="nc">.1.16</span><span class="o">~</span><span class="nt">20110112</span><span class="nc">.114348.7d798fa-1</span><span class="o">)</span>
<span class="nt">The</span> <span class="nt">first</span> <span class="nt">line</span> <span class="nt">of</span> <span class="o">/</span><span class="nt">var</span><span class="o">/</span><span class="nt">cache</span><span class="o">/</span><span class="nt">packaging-farm</span><span class="o">/</span><span class="nt">VCS</span><span class="o">/</span><span class="nt">debian</span><span class="o">/</span><span class="nt">lenny-xivo-gallifrey</span><span class="o">/</span><span class="nt">pf-xivo-sysconfd</span><span class="o">/</span><span class="nt">trunk</span><span class="o">/</span><span class="nt">debian</span><span class="o">/</span><span class="nt">changelog</span> <span class="nt">is</span> <span class="s1">&#39;pf-xivo-sysconfd (1:1.1.16~svn10321-1) lenny-xivo-gallifrey-dev; urgency=low&#39;</span> <span class="nt">and</span> <span class="nt">contains</span> <span class="nt">a</span> <span class="nt">version</span> <span class="o">(</span><span class="nt">1</span><span class="nd">:1</span><span class="nc">.1.16</span><span class="o">~</span><span class="nt">svn10321-1</span><span class="o">)</span> <span class="nt">that</span> <span class="nt">is</span> <span class="nt">greater</span> <span class="nt">or</span> <span class="nt">equal</span> <span class="o">(</span><span class="nt">according</span> <span class="nt">to</span> <span class="nt">dpkg</span> <span class="nt">--compare-versions</span><span class="o">)</span> <span class="nt">than</span> <span class="nt">the</span> <span class="nt">version</span> <span class="nt">computed</span> <span class="nt">by</span> <span class="nt">submit-xivo</span><span class="nc">.sh</span> <span class="o">(</span><span class="nt">1</span><span class="nd">:1</span><span class="nc">.1.16</span><span class="o">~</span><span class="nt">20110304</span><span class="nc">.195243.b9a73dd-1</span><span class="o">)</span>
<span class="nt">The</span> <span class="nt">first</span> <span class="nt">line</span> <span class="nt">of</span> <span class="o">/</span><span class="nt">var</span><span class="o">/</span><span class="nt">cache</span><span class="o">/</span><span class="nt">packaging-farm</span><span class="o">/</span><span class="nt">VCS</span><span class="o">/</span><span class="nt">debian</span><span class="o">/</span><span class="nt">lenny-xivo-gallifrey</span><span class="o">/</span><span class="nt">pf-xivo-utils</span><span class="o">/</span><span class="nt">trunk</span><span class="o">/</span><span class="nt">debian</span><span class="o">/</span><span class="nt">changelog</span> <span class="nt">is</span> <span class="s1">&#39;pf-xivo-utils (3:1.1.16~svn10962-1) lenny-xivo-gallifrey-dev; urgency=low&#39;</span> <span class="nt">and</span> <span class="nt">contains</span> <span class="nt">a</span> <span class="nt">version</span> <span class="o">(</span><span class="nt">3</span><span class="nd">:1</span><span class="nc">.1.16</span><span class="o">~</span><span class="nt">svn10962-1</span><span class="o">)</span> <span class="nt">that</span> <span class="nt">is</span> <span class="nt">greater</span> <span class="nt">or</span> <span class="nt">equal</span> <span class="o">(</span><span class="nt">according</span> <span class="nt">to</span> <span class="nt">dpkg</span> <span class="nt">--compare-versions</span><span class="o">)</span> <span class="nt">than</span> <span class="nt">the</span> <span class="nt">version</span> <span class="nt">computed</span> <span class="nt">by</span> <span class="nt">submit-xivo</span><span class="nc">.sh</span> <span class="o">(</span><span class="nt">3</span><span class="nd">:1</span><span class="nc">.1.16</span><span class="o">~</span><span class="nt">20110804</span><span class="nc">.084947.d48eca0-1</span><span class="o">)</span>
<span class="nt">The</span> <span class="nt">first</span> <span class="nt">line</span> <span class="nt">of</span> <span class="o">/</span><span class="nt">var</span><span class="o">/</span><span class="nt">cache</span><span class="o">/</span><span class="nt">packaging-farm</span><span class="o">/</span><span class="nt">VCS</span><span class="o">/</span><span class="nt">debian</span><span class="o">/</span><span class="nt">lenny-xivo-gallifrey</span><span class="o">/</span><span class="nt">pf-xivo-web-interface</span><span class="o">/</span><span class="nt">trunk</span><span class="o">/</span><span class="nt">debian</span><span class="o">/</span><span class="nt">changelog</span> <span class="nt">is</span> <span class="s1">&#39;pf-xivo-web-interface (7:1.1.16~svn11177-1) lenny-xivo-gallifrey-dev; urgency=low&#39;</span> <span class="nt">and</span> <span class="nt">contains</span> <span class="nt">a</span> <span class="nt">version</span> <span class="o">(</span><span class="nt">7</span><span class="nd">:1</span><span class="nc">.1.16</span><span class="o">~</span><span class="nt">svn11177-1</span><span class="o">)</span> <span class="nt">that</span> <span class="nt">is</span> <span class="nt">greater</span> <span class="nt">or</span> <span class="nt">equal</span> <span class="o">(</span><span class="nt">according</span> <span class="nt">to</span> <span class="nt">dpkg</span> <span class="nt">--compare-versions</span><span class="o">)</span> <span class="nt">than</span> <span class="nt">the</span> <span class="nt">version</span> <span class="nt">computed</span> <span class="nt">by</span> <span class="nt">submit-xivo</span><span class="nc">.sh</span> <span class="o">(</span><span class="nt">7</span><span class="nd">:1</span><span class="nc">.1.16</span><span class="o">~</span><span class="nt">20110802</span><span class="nc">.135651.7f1de42-1</span><span class="o">)</span>
<span class="nt">The</span> <span class="nt">first</span> <span class="nt">line</span> <span class="nt">of</span> <span class="o">/</span><span class="nt">var</span><span class="o">/</span><span class="nt">cache</span><span class="o">/</span><span class="nt">packaging-farm</span><span class="o">/</span><span class="nt">VCS</span><span class="o">/</span><span class="nt">debian</span><span class="o">/</span><span class="nt">lenny-xivo-gallifrey</span><span class="o">/</span><span class="nt">asterisk-addons</span><span class="o">/</span><span class="nt">trunk</span><span class="o">/</span><span class="nt">debian</span><span class="o">/</span><span class="nt">changelog</span> <span class="nt">is</span> <span class="s1">&#39;asterisk-addons (42:1.4.13+pf.xivo.1.1.16~svn10199-6) lenny-xivo-gallifrey-dev; urgency=low&#39;</span> <span class="nt">and</span> <span class="nt">contains</span> <span class="nt">a</span> <span class="nt">version</span> <span class="o">(</span><span class="nt">42</span><span class="nd">:1</span><span class="nc">.4.13</span><span class="o">+</span><span class="nt">pf</span><span class="nc">.xivo.1.1.16</span><span class="o">~</span><span class="nt">svn10199-6</span><span class="o">)</span> <span class="nt">that</span> <span class="nt">is</span> <span class="nt">greater</span> <span class="nt">or</span> <span class="nt">equal</span> <span class="o">(</span><span class="nt">according</span> <span class="nt">to</span> <span class="nt">dpkg</span> <span class="nt">--compare-versions</span><span class="o">)</span> <span class="nt">than</span> <span class="nt">the</span> <span class="nt">version</span> <span class="nt">computed</span> <span class="nt">by</span> <span class="nt">submit-xivo</span><span class="nc">.sh</span> <span class="o">(</span><span class="nt">42</span><span class="nd">:1</span><span class="nc">.4.13</span><span class="o">+</span><span class="nt">pf</span><span class="nc">.xivo.1.1.16</span><span class="o">~</span><span class="nt">20110215</span><span class="nc">.130731.9460139-1</span><span class="o">)</span>
</pre></div>


<p>The same upgrade was done on the gallifrey development build machine.
The command</p>
<div class="highlight"><pre><span></span>packaging-farm --cd gallifrey update
</pre></div>


<p>did not issue any error message and found a number of updates. However,
when running</p>
<div class="highlight"><pre><span></span>packaging-farm gallifrey
</pre></div>


<p>it failed on sangoma-wanpipe with the following error:</p>
<div class="highlight"><pre><span></span>...
/usr/src/sangoma-wanpipe-3.5.17.dfsg.1/kdrvtmp/sdla_tdmv.c:1504: error: &#39;DAHDI_MAINT_LOOPSTOP&#39; undeclared (first use in this function)
/usr/src/sangoma-wanpipe-3.5.17.dfsg.1/kdrvtmp/sdla_tdmv.c: In function &#39;wp_tdmv_rx_dchan&#39;:
/usr/src/sangoma-wanpipe-3.5.17.dfsg.1/kdrvtmp/sdla_tdmv.c:2516: error: &#39;struct dahdi_chan&#39; has no member named &#39;readbufq&#39;
/usr/src/sangoma-wanpipe-3.5.17.dfsg.1/kdrvtmp/sdla_tdmv.c:2517: error: &#39;struct dahdi_chan&#39; has no member named &#39;sel&#39;
/usr/src/sangoma-wanpipe-3.5.17.dfsg.1/kdrvtmp/sdla_tdmv.c:2519: error: &#39;struct dahdi_chan&#39; has no member named &#39;eventbufq&#39;
make[6]: *** [/usr/src/sangoma-wanpipe-3.5.17.dfsg.1/kdrvtmp/sdla_tdmv.o] Error 1
make[5]: *** [_module_/usr/src/sangoma-wanpipe-3.5.17.dfsg.1/kdrvtmp] Error 2
make[4]: *** [all] Error 2

---------------------------------------------

make[3]: *** [common-build-impl] Error 1
dpkg-buildpackage: failure: debian/rules build gave error exit status 2
BUILD END packaging-farm --cd sangoma-wanpipe ARCHITECTURE=i386 DISTRIBUTION=lenny chroot-login
</pre></div>


<p>It turns out that the source package for sangoma-wanpipe could only be
found in the existing repositories (it does not have a corresponding git
directory in the repository) and is probably outdated. On the gallifrey
development machine it shows:</p>
<div class="highlight"><pre><span></span>/var/cache/packaging-farm/sources/sangoma-wanpipe:
  total used in directory 13708 available 12287544
  drwxr-xr-x  3 root     root     4096 May 16 05:41 .
  drwxr-xr-x 48 www-data root    12288 Aug 29 05:16 ..
  drwxr-xr-x 19 root     root     4096 May 16 05:41 sangoma-wanpipe-3.5.17.dfsg.1
  -rw-r--r--  1 root     root    15904 May 13 09:07 sangoma-wanpipe_3.5.17.dfsg.1-1+pf.lenny.xivo.gallifrey.dev.27.diff.gz
  -rw-r--r--  1 root     root     1555 May 13 09:07 sangoma-wanpipe_3.5.17.dfsg.1-1+pf.lenny.xivo.gallifrey.dev.27.dsc
  -rw-r--r--  1 root     root 13971782 Nov 25  2010 sangoma-wanpipe_3.5.17.dfsg.1.orig.tar.gz
</pre></div>


<p>where on the gallifrey machine it shows:</p>
<div class="highlight"><pre><span></span>/var/cache/packaging-farm/sources/sangoma-wanpipe:
  total used in directory 14172 available 6490308
  drwxr-xr-x  3 root     root     4096 Jul 28 10:48 .
  drwxr-xr-x 48 www-data root    12288 Aug 29 04:43 ..
  drwxr-xr-x 19 root     root     4096 Jun 27 05:06 sangoma-wanpipe-3.5.20.dfsg.1
  -rw-r--r--  1 root     root     1266 Jun 27 05:16 sangoma-wanpipe_3.5.20.dfsg.1-1+pf.lenny.xivo.gallifrey.dev.27.dsc
  -rw-r--r--  1 root     root 14465725 Jun 27 05:16 sangoma-wanpipe_3.5.20.dfsg.1-1+pf.lenny.xivo.gallifrey.dev.27.tar.gz
</pre></div>


<p>suggesting that a more recent version is available.</p>
<h4>disk usage optimization</h4>
<p>packaging-farm keeps the complete build environment at all times in the
build directory of a package. When disk space must be saved, there
<a href="http://packaging-farm.dachary.org/trac/ticket/17">should be an option to get rid of
it</a>, at the expense of
slowing the build.The <a href="http://packaging-farm.dachary.org/trac/changeset/f4a5c380a14996e105f10201e3f5a01784ab1225">SAVE_DISK variable is
implemented</a>
to agressively save space (i.e. the apt archives directory is no longer
saved). The chroot used to build a given distribution for a given
architecture is always umounted and removed.The packaging-farm.conf
manual page was updated:</p>
<div class="highlight"><pre><span></span>SAVE_DISK
              After a package is successfully built, remove all the intermedi-
              ary files if SAVE_DISK=yes.  If SAVE_DISK=no or is missing, more
              disk  space  will be used because a number of intermediary files
              are not removed. For  instance  the  packages  loaded  from  the
              Internet  for  a  Debian GNU/Linux package are kept so that they
              can be reused by another build without the need to download them
              again.
</pre></div>


</p>
  </div>
</article>

  <div class="pagination">
    <a class="btn" href="http://blog.xivo.io/index26.html">
      <i class="fa fa-angle-left"></i> Older Posts
    </a>
      <a class="btn float-right" href="http://blog.xivo.io/index24.html">
        Newer Posts <i class="fa fa-angle-right"></i>
      </a>
  </div>

    <footer>
<p>
  &copy; XiVO developers 2015 - This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Create Commons Attribution-ShareAlike 4.0 International License</a>
</p>
<p>Built using <a href="http://getpelican.com" target="_blank">Pelican</a> - <a href="https://github.com/alexandrevicenzi/flex" target="_blank">Flex</a> theme by <a href="http://alexandrevicenzi.com" target="_blank">Alexandre Vicenzi</a></p><p>
  <a rel="license"
     href="http://creativecommons.org/licenses/by-sa/4.0/"
     target="_blank">
    <img alt="Creative Commons License"
         title="Creative Commons License"
         style="border-width:0"
         src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png"
         width="80"
         height="15"/>
  </a>
</p>    </footer>
  </main>
<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " XiVO Blog ",
  "url" : "http://blog.xivo.io",
  "image": "public/xivo-logo.png",
  "description": ""
}
</script></body>
</html>