<!DOCTYPE html>
<html lang="en">
<head>
  <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,400italic' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" type="text/css" href="http://blog.xivo.io/theme/css/style.min.css">
  <link rel="stylesheet" type="text/css" href="http://blog.xivo.io/theme/css/pygments.min.css">
  <link rel="stylesheet" type="text/css" href="http://blog.xivo.io/theme/css/font-awesome.min.css">
  <link href="http://blog.xivo.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="XiVO Blog Atom">
  <link rel="shortcut icon" href="/public/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/public/favicon.ico" type="image/x-icon">

  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="" />
  <meta name="author" content="XiVO developers" />
  <meta name="description" content="" />
<meta property="og:site_name" content="XiVO Blog"/>
<meta property="og:type" content="blog"/>
<meta property="og:title" content="XiVO Blog"/>
<meta property="og:description" content=""/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="http://blog.xivo.io"/>
<meta property="og:image" content="public/xivo-logo.png">
  <title>XiVO Blog</title>
</head>
<body>
  <aside>
    <div>
      <a href="http://blog.xivo.io">
        <img src="public/xivo-logo.png" alt="" title="">
      </a>
      <h1><a href="http://blog.xivo.io"></a></h1>
      <p></p>
      <nav>
        <ul class="list">
          <li><a href="http://xivo.io" target="_blank">XiVO.io</a></li>
          <li><a href="http://documentation.xivo.io" target="_blank">Documentation</a></li>
        </ul>
      </nav>
      <ul class="social">
        <li><a class="sc-twitter" href="http://twitter.com/xivodevteam" target="_blank"><i class="fa fa-twitter"></i></a></li>
        <li><a class="sc-github" href="http://github.com/xivo-pbx" target="_blank"><i class="fa fa-github"></i></a></li>
        <li><a class="sc-facebook" href="https://www.facebook.com/XiVO-86529730831" target="_blank"><i class="fa fa-facebook"></i></a></li>
      </ul>
    </div>
  </aside>
  <main>
    <nav>
      <a href="http://blog.xivo.io">Home</a>
      <a href="/categories.html">Categories</a>
      <a href="/archives.html">Archives</a>
      <a href="http://blog.xivo.io/feeds/all.atom.xml">Atom</a>
    </nav>

<article>
  <header>
    <h2><a href="http://blog.xivo.io/testing-a-xivo-gallifrey-repository-22.html#testing-a-xivo-gallifrey-repository-22">Testing a XiVO gallifrey repository (2/2)</a></h2>
    <p>
      Posted on Mon 16 May 2011 in <a href="http://blog.xivo.io/category/xivo-ipbx.html">XiVO IPBX</a>
      &#8226; Tagged with
      <a href="http://blog.xivo.io/tag/packages.html">packages</a>    </p>
  </header>
  <div>
      <h4>SVN keyword substitution bug fix</h4>
<p>In some of the installed software (ctiservers) the SVN keywords are used
to extract the software version number:</p>
<div class="highlight"><pre><span class="x">__version__ = &quot;</span><span class="p">$</span><span class="nv">Revision</span><span class="p">$</span><span class="x">&quot;</span>
</pre></div>


<p>However, since the binaries have been built from a git repository with a
different naming scheme, thisno longer works. Corentin Le Gall fixed the
problem immediately in the internal SVN repository</p>
<div class="highlight"><pre>------------------------------------------------------------------------
r10824 | kaou | 2011-05-16 11:08:49 +0200 (Mon, 16 May 2011) | 1 line
[bugfix] remove svn-dependent stuff because of git migration
------------------------------------------------------------------------
</pre></div>


<p>The <a href="http://git.xivo.fr/xivo-gallifrey.git/">git repository</a> was
supposed to be updated by a cron job, but it crashed May 9th and was
restarted May 16th by Romain Bignon:</p>
<div class="highlight"><pre><span class="n">commit</span> <span class="n">a9f7ebff1a4db73184809a1696eb3b03b82b00f5</span>
<span class="nl">Author</span><span class="p">:</span> <span class="n">Corentin</span> <span class="n">Le</span> <span class="n">Gall</span> <span class="o">&lt;</span><span class="n">clegall</span><span class="p">@</span><span class="n">proformatique</span><span class="p">.</span><span class="n">com</span><span class="o">&gt;</span>
<span class="nl">Date</span><span class="p">:</span>   <span class="n">Mon</span> <span class="n">May</span> <span class="mi">16</span> <span class="mi">09</span><span class="o">:</span><span class="mi">33</span><span class="o">:</span><span class="mi">47</span> <span class="mi">2011</span> <span class="o">+</span><span class="mo">0000</span>

    <span class="n">remove</span> <span class="n">svn</span><span class="o">-</span><span class="n">dependent</span> <span class="n">stuff</span> <span class="n">because</span> <span class="n">of</span> <span class="n">git</span> <span class="n">migration</span>

    <span class="n">git</span><span class="o">-</span><span class="n">svn</span><span class="o">-</span><span class="kt">id</span><span class="o">:</span> <span class="nl">https</span><span class="p">:</span><span class="c1">//rcs.lan.proformatique.com/svn/xivo/branches/official/1.1-gallifrey@10825 dc85baef-7018-0410-bfbd-8a639da648bb</span>
</pre></div>


<p>After the git pull, the logs showed that some packages were modified.
They were submitted to the farm:</p>
<div class="highlight"><pre>packaging-farm DIRECTORY=ctiservers submit
packaging-farm DIRECTORY=asterisk submit
packaging-farm DIRECTORY=agid submit
packaging-farm DIRECTORY=lib-python submit
</pre></div>


<p>and a rebuild of gallifrey was requested.</p>
<div class="highlight"><pre>packaging-farm gallifrey
</pre></div>


<h4>collecting symbolic links</h4>
<p>A few packages contain symbolic links that point outside of their
directory:</p>
<div class="highlight"><pre>gwr.py -&gt; ../tools/gwr.py
</pre></div>


<p>When building the source package by assembling the debian directory and
the sourcedirectory, the actual file must be put in the archive instead
of the symbolic link.</p>
<div class="highlight"><pre><span class="x">for dir in app_nv_faxdetect app_fax ami_aoriginate module_xivo res_config_sqlite ; </span>
<span class="x">  do RSYNC_OPTIONS=--copy-unsafe-links packaging-farm DIRECTORY=</span><span class="p">$</span><span class="nv">dir</span><span class="x"> submit ;</span>
<span class="x">done</span>
</pre></div>


<p>The RSYNC_OPTIONS variable already existed in the <em>submit-xivo.sh</em>
script but was not documented. A chapterwas added to the manual page:</p>
<div class="highlight"><pre><span class="x">RSYNC_OPTIONS=</span>
<span class="x">              Before  the debian directory is assembled with the source direc-</span>
<span class="x">              tory, a  copy  is  made  using  rsync(1).  The  content  of  the</span>
<span class="x">              RSYNC_OPTIONS  variable  is  given in argument to the rsync com-</span>
<span class="x">              mand. For instance it may be used to collect the actual  content</span>
<span class="x">              of symbolic links pointing outside of the source directory.</span>
<span class="x">              for dir in app_nv_faxdetect app_fax ami_aoriginate module_xivo res_config_sqlite ;</span>
<span class="x">                do RSYNC_OPTIONS=--copy-unsafe-links packaging-farm DIRECTORY=</span><span class="p">$</span><span class="nv">dir</span><span class="x"> submit ;</span>
<span class="x">              done</span>
</pre></div>


<p>Before installing <em>pf-xivo</em> it was necessary to install the
<em>dahdi-linux</em> kernel module.</p>
<div class="highlight"><pre>apt-get install dahdi-linux-modules-2.6.26-2-686 
apt-get install pf-xivo
</pre></div>


<p>It was then possible to connect to the XiVO web interface:<img alt="alternate
XiVO" src="/public/.Screenshot-5_m.jpg" title="alternate XiVO, May 2011" /></p>
<h4>gallifrey reference</h4>
<p>ganeti instanceA new host is declared in the local DNS</p>
<div class="highlight"><pre><span class="x">root@host01:/etc/bind</span><span class="err">#</span><span class="x"> git diff .</span>
<span class="x">diff --git a/bind/db.10.10 b/bind/db.10.10</span>
<span class="x">index 684d569..ea30300 100644</span>
<span class="x">--- a/bind/db.10.10</span>
<span class="x">+++ b/bind/db.10.10</span>
<span class="x">@@ -4,7 +4,7 @@</span>
<span class="x"> ;</span>
<span class="x"> </span><span class="p">$</span><span class="nv">TTL</span><span class="x">    604800</span>
<span class="x"> @       IN      SOA     localhost. root.localhost. (</span>
<span class="x">-        2011041800      ; serial</span>
<span class="x">+        2011051601      ; serial</span>
<span class="x">                          604800         ; Refresh</span>
<span class="x">                           86400         ; Retry</span>
<span class="x">                         2419200         ; Expire</span>
<span class="x">@@ -14,6 +14,9 @@ </span><span class="p">$</span><span class="nv">TTL</span><span class="x">    604800</span>
<span class="x"> ;;</span>
<span class="x"> ;; perl -n -e &#39;print if(s/(\S+)\s+IN\s+A\s+10\.10\.(\d+)\.(\d+)/\3.\2\tIN\tPTR\t\1.farm./)&#39; &lt; db.farm</span>
<span class="x"> ;;</span>
<span class="x"> 1.60   IN      PTR     dev.dachary.vm.farm.</span>
<span class="x"> 2.60   IN      PTR     skaro.xivo.vm.farm.</span>
<span class="x"> 3.60   IN      PTR     gallifrey.xivo.vm.farm.</span>
<span class="x">+4.60   IN      PTR     gallifrey-test1.xivo.vm.farm.</span>
<span class="x">diff --git a/bind/db.farm b/bind/db.farm</span>
<span class="x">index 60da05a..2e4c669 100644</span>
<span class="x">--- a/bind/db.farm</span>
<span class="x">+++ b/bind/db.farm</span>
<span class="x">@@ -4,7 +4,7 @@ </span><span class="p">$</span><span class="nv">TTL</span><span class="x"> 1h ; default Time-to-Live. defines the duration that the record may be cach</span>

<span class="x"> </span><span class="p">$</span><span class="nv">ORIGIN</span><span class="x"> farm.</span>
<span class="x"> @                       IN      SOA             ns hostmaster (</span>
<span class="x">-                        2011041800      ; serial</span>
<span class="x">+                        2011051601      ; serial</span>
<span class="x">                                 1h              ; refresh - time when the slave will try to refresh the zone from the mast</span>
<span class="x">                                 30m             ; update retry - time between retries if the slave (secondary) (2h)</span>
<span class="x">                                                 ; fails to contact the master when refresh (above) has expired.</span>
<span class="x">@@ -22,3 +22,4 @@ host01                IN      A       10.10.59.10</span>
<span class="x"> dev.dachary.vm         IN      A       10.10.60.1</span>
<span class="x"> skaro.xivo.vm          IN      A       10.10.60.2</span>
<span class="x"> gallifrey.xivo.vm      IN      A       10.10.60.3</span>
<span class="x">+gallifrey-test1.xivo.vm        IN      A       10.10.60.4</span>
</pre></div>


<p>An entry is allocated in the DHCP server, configured with a server to be
used for network boot.</p>
<div class="highlight"><pre><span class="gh">diff --git a/bind/db.farm b/bind/db.farm</span>
<span class="gh">index 60da05a..2e4c669 100644</span>
<span class="gd">--- a/bind/db.farm</span>
<span class="gi">+++ b/bind/db.farm</span>
<span class="gu">@@ -4,7 +4,7 @@ $TTL 1h ; default Time-to-Live. defines the duration that the record may be cach</span>

 $ORIGIN farm.
 @                       IN      SOA             ns hostmaster (
<span class="gd">-                        2011041800      ; serial</span>
<span class="gi">+                        2011051601      ; serial</span>
                                 1h              ; refresh - time when the slave will try to refresh the zone from the mast
                                 30m             ; update retry - time between retries if the slave (secondary) (2h)
                                                 ; fails to contact the master when refresh (above) has expired.
<span class="gu">@@ -22,3 +22,4 @@ host01                IN      A       10.10.59.10</span>
 dev.dachary.vm         IN      A       10.10.60.1
 skaro.xivo.vm          IN      A       10.10.60.2
 gallifrey.xivo.vm      IN      A       10.10.60.3
<span class="gi">+gallifrey-test1.xivo.vm        IN      A       10.10.60.4</span>
</pre></div>


<p>A ganeti based virtual machine is created with a VNC port enabled:</p>
<div class="highlight"><pre>gnt-instance add -d -t plain -s 5G -B memory=512M,vcpus=1 \
   -H kvm:boot_order=network,vnc_bind_address=0.0.0.0 -n host01.farm \
   -o debootstrap+default --net 0:mac=52:54:24:1e:63:28 \
   gallifrey-test1.xivo.vm.farm
</pre></div>


<p>At boot time the menu options <em>Production</em> and <em>Gallifrey</em> are
selected.The firewall was reconfigured to accept HTTPS connections
because it is the default when connecting to thevirtual machine with a
browser (it gets redirected when trying with HTTP):</p>
<div class="highlight"><pre><span class="gh">diff --git a/shorewall/rules b/shorewall/rules</span>
<span class="gh">index 3a7ea65..da38d67 100644</span>
<span class="gd">--- a/shorewall/rules</span>
<span class="gi">+++ b/shorewall/rules</span>
<span class="gu">@@ -39,6 +39,7 @@ ACCEPT                $FW             net             icmp</span>

 SSH(ACCEPT)    net             $FW
 HTTP(ACCEPT)   net             $FW
<span class="gi">+HTTPS(ACCEPT)  net             $FW</span>
 # VNC ganeti
 ACCEPT         net             $FW             tcp     11000:11010
 # VNC libvirt
</pre></div>


<p>The nginx reverse proxy was configured to proxy SSL requests, after
generating a certificateaccording to <a href="http://wiki.nginx.org/HttpSslModule">the SSL
module</a> instructions:</p>
<div class="highlight"><pre><span class="nt">server</span> <span class="p">{</span>
 <span class="n">ssl</span> <span class="n">on</span><span class="p">;</span>
 <span class="n">listen</span> <span class="m">443</span><span class="p">;</span>
 <span class="n">server_name</span> <span class="n">gallifrey</span><span class="o">-</span><span class="n">test1</span><span class="o">.</span><span class="n">dachary</span><span class="o">.</span><span class="n">org</span><span class="p">;</span>
 <span class="n">access_log</span>  <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">gallifrey</span><span class="o">.</span><span class="n">dachary</span><span class="o">.</span><span class="n">org</span><span class="o">.</span><span class="n">access</span><span class="o">.</span><span class="n">log</span><span class="p">;</span>
 <span class="n">ssl_certificate</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">server</span><span class="o">.</span><span class="n">crt</span><span class="p">;</span>
 <span class="n">ssl_certificate_key</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">server</span><span class="o">.</span><span class="n">key</span><span class="p">;</span>

 <span class="n">location</span> <span class="o">/</span> <span class="err">{</span>
  <span class="n">proxy_pass</span> <span class="n">https</span><span class="o">://</span><span class="n">gallifrey</span><span class="o">-</span><span class="n">test1</span><span class="o">.</span><span class="n">xivo</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">farm</span><span class="o">:</span><span class="m">443</span><span class="p">;</span>
<span class="err">#</span>  <span class="n">proxy_set_header</span> <span class="n">Host</span> <span class="err">$</span><span class="n">host</span><span class="p">;</span>       
 <span class="p">}</span>
<span class="err">}</span>
</pre></div>


<p>And the <a href="https://gallifrey-test1.dachary.org/">XiVO web interface</a> could
be displayed.</p>
</p>
  </div>
  <hr />
</article>
<article>
  <header>
    <h2><a href="http://blog.xivo.io/glimpse-of-cti-architecture-in-xivo-11-and-12.html#glimpse-of-cti-architecture-in-xivo-11-and-12">Glimpse of CTI architecture in XiVO 1.1 and 1.2</a></h2>
    <p>
      Posted on Fri 13 May 2011 in <a href="http://blog.xivo.io/category/xivo-ipbx.html">XiVO IPBX</a>
    </p>
  </header>
  <div>
      <p>As a reminder, this is what the CTI world looks like in XiVO 1.1 :</p>
<p><a href="/public/external_cti_architecture_xivo_1.1.png" title="cti1.1"><img alt="cti1.1" src="/public/.external_cti_architecture_xivo_1.1_m.jpg" title="cti1.1, mai 2011" /></a></p>
<p>The XiVO 1.2 part will be more like :</p>
<p><a href="/public/external_cti_architecture_xivo_1.2.png" title="cti1.2"><img alt="cti1.2" src="/public/.external_cti_architecture_xivo_1.2_m.jpg" title="cti1.2, mai 2011" /></a></p>
<p>namely :</p>
<ul>
<li>the queue-logger daemon does not exist any more, and the CTI server
    fills the queue-logger database itself</li>
<li>the services/features of user lines will be accessed through regular
    XiVO web services instead of direct SQL access</li>
</ul>
<p>This is of course only a very global view.</p>
<p>At the underneath level,</p>
<ul>
<li>the AMI commands have changed, since the asterisk version will be
    1.8 (instead of 1.4)</li>
<li>the CTI protocol between the server and its clients has evolved,
    especially in order to be able to get smaller payload packet sizes.</li>
</ul>
<p>More details should come in a future blog entry.</p>
</p>
  </div>
  <hr />
</article>
<article>
  <header>
    <h2><a href="http://blog.xivo.io/testing-a-xivo-gallifrey-repository-12.html#testing-a-xivo-gallifrey-repository-12">Testing a XiVO gallifrey repository (1/2)</a></h2>
    <p>
      Posted on Mon 09 May 2011 in <a href="http://blog.xivo.io/category/xivo-ipbx.html">XiVO IPBX</a>
      &#8226; Tagged with
      <a href="http://blog.xivo.io/tag/packages.html">packages</a>    </p>
  </header>
  <div>
      <h4>Methodology</h4>
<p>Assuming a host running <a href="http://www.debian.org/releases/squeeze/">Debian GNU/Linux
Squeeze</a>, the general idea is
to boot a virtual machine thatwill auto-install using
<a href="http://www.debian.org/devel/debian-installer/">debian-installer</a> so
that it uses <a href="http://git.proformatique.com/?p=official/debian-installer.git;a=tree;f=squeeze/classes/skaro-farm;h=155b14e82c906b968d6d42a7b8e20faf0209d687;hb=692498d23dcd2daa173e2ed152010b6c22dd7fda">a specific
class</a>
that will pull packages from <a href="http://xivo.dachary.org/packaging-farm/gallifrey/gnulinux/debian/">the
gallifrey</a>
repository <a href="http://blog.xivo.fr/index.php?post/2011/04/27/An-alternate-XiVO-gallifrey-repository-%28part-2/2%29">created with
packaging-farm</a>.</p>
<h4>Virtual machine</h4>
<p>The <a href="http://libvirt.org/">libvirt</a> virtual machine is given 512MB RAM,
8GB RAW disk image, 1CPU.The configuration of libvirt is made to accept
VNC connections from anywhere to gain access tothe console over the
network:</p>
<div class="highlight"><pre><span class="gh">diff --git a/libvirt/qemu.conf b/libvirt/qemu.conf</span>
<span class="gh">index dc8eb83..282e734 100644</span>
<span class="gd">--- a/libvirt/qemu.conf</span>
<span class="gi">+++ b/libvirt/qemu.conf</span>
<span class="gu">@@ -9,7 +9,7 @@</span>
 # NB, strong recommendation to enable TLS + x509 certificate
 # verification when allowing public access
 #
<span class="gd">-# vnc_listen = &quot;0.0.0.0&quot;</span>
<span class="gi">+vnc_listen = &quot;0.0.0.0&quot;</span>


 # Enable use of TLS encryption on the VNC server. This requires
</pre></div>


<h4>dhcpd and network boot</h4>
<p>The dhcp server is instructed to allow for network boot in
<em>/etc/dhcp/dhcpd.conf</em></p>
<div class="highlight"><pre>subnet 10.10.70.0 netmask 255.255.255.0 {
        range 10.10.70.70 10.10.70.100;
        filename &quot;pxelinux&quot;;
        next-server 10.10.70.254;
        option domain-name &quot;farm&quot;;
        option domain-name-servers 10.10.70.254;
        option subnet-mask 255.255.255.0;
        option broadcast-address 10.10.70.255;
        option routers 10.10.70.254;
}
</pre></div>


<p>The TFTP server is installed:</p>
<div class="highlight"><pre>apt-get install tftpd-hpa
</pre></div>


<p>The kernel and pxelinux configuration files are <a href="http://ftp.debian.org/debian/dists/lenny/main/installer-i386/current/images/netboot/debian-installer/i386">copied from a i386
lenny
directory</a>
into <em>/var/lib/tftp/</em>. Actually a more elaborated variation rsync'ed
from a machine on the avencall lan named kenny.avencall.com but this is
not strictly necessary for the test: fai-linux-lenny below is equivalent
to
<a href="http://ftp.debian.org/debian/dists/lenny/main/installer-i386/current/images/netboot/debian-installer/i386/linux">linux</a>
and fai-initrd-lenny is equivalent to
<a href="http://ftp.debian.org/debian/dists/lenny/main/installer-i386/current/images/netboot/debian-installer/i386/initrd.gz">initrd</a>.The
libvirt configuration of the virtual machineis instructed to boot from
the network:</p>
<div class="highlight"><pre><span class="nt">&lt;os&gt;</span>
    <span class="nt">&lt;type</span> <span class="na">arch=</span><span class="s">&#39;i686&#39;</span> <span class="na">machine=</span><span class="s">&#39;pc-0.12&#39;</span><span class="nt">&gt;</span>hvm<span class="nt">&lt;/type&gt;</span>
    <span class="nt">&lt;boot</span> <span class="na">dev=</span><span class="s">&#39;network&#39;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;boot</span> <span class="na">dev=</span><span class="s">&#39;cdrom&#39;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;boot</span> <span class="na">dev=</span><span class="s">&#39;hd&#39;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;bootmenu</span> <span class="na">enable=</span><span class="s">&#39;no&#39;</span><span class="nt">/&gt;</span>
</pre></div>


<p>When the virtual machine is started with</p>
<div class="highlight"><pre>virsh start skaro.xivo.vm.test
</pre></div>


<p>it will show the following and be ready to boot from the
network.<img alt="d-i" src="/public/.i_m.jpg" title="d-i, May 2011" />A new entry has been
added to the menu displayed:</p>
<div class="highlight"><pre>label xivo_gallifrey_farm
        menu label gallifrey-farm
        kernel fai-linux-lenny
        append initrd=fai-initrd-lenny rw auto=true url=http://66.254.41.119 priority=critical locale=en_US.UTF-8 interface=auto netcfg/dhcp_timeout=60 classes=debug,xivo-gallifrey-farm hostname=xivo --
</pre></div>


<p>in the file <em>/var/lib/tftp/pxelinux.cfg/xivo_devel/xivo_devel.cfg</em>
that has beenextracted with</p>
<div class="highlight"><pre>cd /var/lib/tftp
git clone git://git.proformatique.com/official/debian-pxelinux.git pxelinux.cfg
</pre></div>


<p>and contains all the menu for all the XiVO configurations.</p>
<h4>Other packages</h4>
<p>The <a href="http://66.254.41.119/d-i/lenny/classes/xivo-gallifrey-farm/postinst_script">debian-installer
script</a>
starts by installing <a href="pf-fai-xivo-1.1-gallifrey-farm">a package</a> whose
sole purpose is to add files in the /etc/apt/sources.list.d/ so that
packages are extracted from the . The sources of the package are in the
packages/branches/official/lenny/pf-fai/ directory of the internal
rcs.lan.proformatique.com/rcs/svn/common-softwares repository. They can
also be retrieved from the package sources at</p>
<div class="highlight"><pre><span class="k">deb-src</span> <span class="s">http://dak.proformatique.com/debian</span> <span class="kp">lenny</span> <span class="kp">main</span>
</pre></div>


<p>with the command</p>
<div class="highlight"><pre>apt-get source pf-fai
</pre></div>


<h4>Installation</h4>
<p>All the common files are in the <a href="http://66.254.41.119/d-i/lenny/">lenny
directory</a>, forinstance the
<a href="http://66.254.41.119/d-i/lenny/preseed.cfg">preseed.cfg</a> and
<a href="http://66.254.41.119/d-i/lenny/installer.cfg">installer.cfg</a> that sets
the passwords and other package values.</p>
<div class="highlight"><pre><span class="x">d-i passwd/root-password-crypted password </span><span class="p">$</span><span class="x">1</span><span class="p">$</span><span class="nv">NHxfkWun</span><span class="p">$</span><span class="nv">PMGLFNFtPKwIFT532sinD1</span><span class="x"></span>
</pre></div>


<p>That should be replaced with a known password, for instance:</p>
<div class="highlight"><pre>d-i passwd/root-password password foobar
</pre></div>


<p>otherwise it will be impossible to login.The installation asks for the
disk partition. If it fails,the error logs can be found at
<em>/var/log/pf-fai/postinst.log</em>The key of the packaging-farm repository
is addedto
<a href="http://66.254.41.119/d-i/lenny/classes/xivo-gallifrey-farm/late_script">late_script</a></p>
<div class="highlight"><pre>if [ -x /usr/bin/apt-key ]; then
        apt-get -y install gnupg
        wget http://gallifrey.dachary.org/gallifrey.gpg -O - | apt-key add -
fi
</pre></div>


<p>It also removes any repository added by
<a href="http://66.254.41.119/d-i/lenny/late_script_target">late_script_target</a>
and replace them with the packaging-farm repository:</p>
<div class="highlight"><pre><span class="k">deb</span> <span class="s">http://gallifrey.dachary.org/packaging-farm/gallifrey/gnulinux/debian</span> <span class="kp">gallifrey-lenny</span> <span class="kp">main</span>
</pre></div>


<p>If a script (such as late_script) fails, the error message can be found
after login on the machine in the <em>/var/log/installer/syslog</em> file.</p>
<h4>gallifrey distribution</h4>
<p>The <a href="http://gallifrey.dachary.org/packaging-farm/">gallifrey
distribution</a> has been
updated to include the <em>misdn-user</em> package that was missing from the
list although it was already created. The <em>pf-asterisk-module-xivo</em>,
<em>pf-asterisk-res-sqlite2</em>, <em>pf-asterisk-ami-aoriginate</em>,
<em>asterisk-chan-sccp</em>, <em>pf-asterisk-app-fax</em>,
<em>pf-asterisk-app-nv-faxdetect</em> packages were imported into the farm from
the <a href="http://dak.proformatique.com/debian/dists/lenny-xivo-gallifrey-dev/">official
repository</a>
and added to the list of packages necessary to install gallifrey.</p>
</p>
  </div>
  <hr />
</article>
<article>
  <header>
    <h2><a href="http://blog.xivo.io/xivo-from-2007-until-now-with-gource.html#xivo-from-2007-until-now-with-gource">XiVO from 2007 until now with Gource</a></h2>
    <p>
      Posted on Fri 06 May 2011 in <a href="http://blog.xivo.io/category/articles.html">articles</a>
      &#8226; Tagged with
      <a href="http://blog.xivo.io/tag/gource.html">gource</a>,      <a href="http://blog.xivo.io/tag/xivo.html">xivo</a>    </p>
  </header>
  <div>
      <p><em>5 years of development, 24 contributors, 7824 commits, 195k lines of
code.</em><br />
History of Xivo in 2'30 minutes, done with Gource.</p>
<iframe width="425" height="349" src="http://www.youtube.com/embed/g0jI9A53BoM" frameborder="0" allowfullscreen>
</iframe>

</p>
  </div>
  <hr />
</article>
<article>
  <header>
    <h2><a href="http://blog.xivo.io/xivo-packages-versions.html#xivo-packages-versions">XiVO packages versions</a></h2>
    <p>
      Posted on Mon 02 May 2011 in <a href="http://blog.xivo.io/category/xivo-ipbx.html">XiVO IPBX</a>
      &#8226; Tagged with
      <a href="http://blog.xivo.io/tag/packages.html">packages</a>    </p>
  </header>
  <div>
      <h4>package names and multiple distributions</h4>
<p>As it is, packaging-farm will create packages with names that are not
dependent on the distribution. It creates a problem that is immediately
visible when trying to build a repository that includes all the
packages: the pool can only accomodate for a single package with a given
name.When building packages for multiple distributions, packaging-farm
should rename the packages built so that they carry the distribution
name. The names must compare in the same order as the distribution
chronology. For instance, <em>foo-1.2-1</em> would be renamed into
<em>foo-1.2-1\~3wheezy</em>. Such a behavior is intrusive and may not be
appropriate if building for a single distribution. The proposed names
are as follow, for each of the supported distributions, following the
<a href="http://backports.debian.org/Contribute/#index5h3">Debian GNU/Linux
backport</a> naming
scheme, with the distribution name added for clarity:</p>
<div class="highlight"><pre>* <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;https://wiki.ubuntu.com/Releases&quot;</span><span class="nt">&gt;</span>Ubuntu<span class="nt">&lt;/a&gt;</span>
** natty = ~bpo1104natty+1
** maverick = ~bpo1010maverick+1
** lucid = ~bpo1004lucid+1
** etc.
* <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;http://wiki.debian.org/DebianReleases&quot;</span><span class="nt">&gt;</span>Debian GNU/Linux<span class="nt">&lt;/a&gt;</span>
** wheezy = ~bpo70wheezy+1
** squeeze = ~bpo60squeeze+1
** lenny = ~bpo50lenny+1
** etch = ~bpo40etch+1
** etc.
</pre></div>


<p>For the record, here is the chat log that led to the proposal above.</p>
<div class="highlight"><pre><span class="p">(</span><span class="mi">10</span><span class="s-Atom">:</span><span class="mi">29</span><span class="s-Atom">:</span><span class="mi">46</span> <span class="nv">AM</span><span class="p">)</span> <span class="nn">loicd</span><span class="p">:</span> <span class="nv">Hi</span><span class="p">,</span> <span class="nv">I</span><span class="s-Atom">&#39;m facing a problem organizing repositories made with reprepro. A package (the name is xivo) is fit to build for Debian wheezy, unstable &amp; Ubunty maverick and naty, for i386 &amp; amd64, without requiring any change. Because reprepro uses a pool to store the packages, these four packages (for wheezy, unstable, maverick &amp; naty) cannot coexist with the exact same name. I could either a) change the package name by adding the target distribution although these packages are strictly identical, b) make a separate repository for each distribution (which still is useful to aggregate the various architectures). Do you have any advice ?</span>
<span class="s-Atom">(10:30:43 AM) twb: FWIW I just use apt-ftparchive</span>
<span class="s-Atom">(10:31:44 AM) twb: http://paste.debian.net/115729/</span>
<span class="s-Atom">(10:31:49 AM) twb: Not very nice, but it does the job</span>
<span class="s-Atom">(10:32:51 AM) loicd: twb: you mean that it is imune to this kind of trouble (the pool) ? (10:34:57 AM) twb: Basically each dir is an apt repo</span>
<span class="s-Atom">(10:35:26 AM) twb: So instead of dists/ and pool/x/xivo, you&#39;d</span> <span class="s-Atom">just</span> <span class="s-Atom">have</span> <span class="s-Atom">xivo</span><span class="o">/</span> <span class="s-Atom">as</span> <span class="s-Atom">a</span> <span class="s-Atom">repo</span><span class="p">,</span> <span class="s-Atom">and</span> <span class="s-Atom">you</span> <span class="s-Atom">can</span> <span class="s-Atom">point</span> <span class="s-Atom">whatever</span> <span class="s-Atom">distros</span> <span class="s-Atom">you</span> <span class="s-Atom">want</span> <span class="s-Atom">at</span> <span class="nf">it</span>
<span class="p">(</span><span class="mi">10</span><span class="s-Atom">:</span><span class="mi">41</span><span class="s-Atom">:</span><span class="mi">02</span> <span class="nv">AM</span><span class="p">)</span> <span class="nn">loicd</span><span class="p">:</span> <span class="nn">twb</span><span class="p">:</span> <span class="s-Atom">it</span> <span class="s-Atom">looks</span> <span class="s-Atom">like</span> <span class="s-Atom">what</span> <span class="nv">I</span><span class="s-Atom">&#39;m after. One drawback of having the same package name for two distro is upgrade. The following use case is broken : a) install wheezy + xivo, b) upgrade to unstable =&gt; xivo does not get upgraded. Although the source packages are the same, the resulting .deb are different because the context is different. The ideal situation would be to be able to create .deb with a name that contains the distro in such a way that it upgrades.</span>
<span class="s-Atom">(10:41:54 AM) ***OdyX does -1 upload to Debian, then -1~n0 to natty, -1~m0 to maverick -1~l0 to lucid.</span>
<span class="s-Atom">(10:44:39 AM) loicd: OdyX: smart :-)</span>
<span class="s-Atom">(10:45:24 AM) OdyX: loicd: more or less ~. It means you have to rebuild+upload each time (only source if you upload to PPAs)</span>
<span class="s-Atom">(10:46:55 AM) loicd: twb: I actually have the same problem with squeeze + wheezy. </span>
<span class="s-Atom">(10:47:09 AM) twb: loicd: squeeze is BPO&#39;s</span> <span class="s-Atom">problem</span><span class="p">,</span> <span class="o">not</span> <span class="s-Atom">yours</span> <span class="s-Atom">:</span><span class="nv">P</span>
<span class="p">(</span><span class="mi">10</span><span class="s-Atom">:</span><span class="mi">47</span><span class="s-Atom">:</span><span class="mi">20</span> <span class="nv">AM</span><span class="p">)</span> <span class="nn">loicd</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="s-Atom">~s0</span> <span class="o">=</span> <span class="s-Atom">squeeze</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="s-Atom">~</span><span class="nf">w0</span> 
<span class="p">(</span><span class="mi">10</span><span class="s-Atom">:</span><span class="mi">47</span><span class="s-Atom">:</span><span class="mi">24</span> <span class="nv">AM</span><span class="p">)</span> <span class="nn">loicd</span><span class="p">:</span> <span class="s-Atom">that</span> <span class="s-Atom">works</span> <span class="nf">too</span>
<span class="p">(</span><span class="mi">11</span><span class="s-Atom">:</span><span class="mi">10</span><span class="s-Atom">:</span><span class="mi">37</span> <span class="nv">AM</span><span class="p">)</span> <span class="nn">loicd</span><span class="p">:</span> <span class="nn">twb</span><span class="p">:</span> <span class="s-Atom">actually</span><span class="p">,</span> <span class="s-Atom">it</span> <span class="o">is</span><span class="p">.</span> <span class="nv">The</span> <span class="s-Atom">vendor</span> <span class="s-Atom">of</span> <span class="s-Atom">the</span> <span class="s-Atom">software</span> <span class="s-Atom">needs</span> <span class="s-Atom">to</span> <span class="s-Atom">provide</span> <span class="s-Atom">squeeze</span> <span class="s-Atom">backports</span> <span class="s-Atom">to</span> <span class="s-Atom">its</span> <span class="s-Atom">clients</span><span class="p">.</span> <span class="nv">This</span> <span class="s-Atom">happens</span> <span class="s-Atom">usually</span> <span class="s-Atom">in</span> <span class="s-Atom">a</span> <span class="s-Atom">rush</span> <span class="s-Atom">and</span> <span class="s-Atom">before</span> <span class="s-Atom">it</span> <span class="s-Atom">becomes</span> <span class="s-Atom">available</span> <span class="s-Atom">to</span> <span class="s-Atom">bpo</span><span class="p">.</span> <span class="nv">It</span> <span class="s-Atom">actually</span> <span class="o">is</span> <span class="s-Atom">a</span> <span class="s-Atom">concern</span> <span class="s-Atom">shared</span> <span class="s-Atom">by</span> <span class="s-Atom">most</span> <span class="s-Atom">software</span> <span class="s-Atom">vendors</span> <span class="s-Atom">:</span> <span class="s-Atom">the</span> <span class="s-Atom">delays</span> <span class="s-Atom">between</span> <span class="s-Atom">meeting</span> <span class="s-Atom">the</span> <span class="s-Atom">client</span> <span class="s-Atom">request</span> <span class="s-Atom">and</span> <span class="s-Atom">meeting</span> <span class="s-Atom">the</span> <span class="s-Atom">debian</span> <span class="s-Atom">requirements</span> <span class="s-Atom">do</span> <span class="o">not</span> <span class="s-Atom">always</span> <span class="s-Atom">match</span><span class="p">.</span>
<span class="p">(</span><span class="mi">11</span><span class="s-Atom">:</span><span class="mi">41</span><span class="s-Atom">:</span><span class="mi">55</span> <span class="nv">AM</span><span class="p">)</span> <span class="nn">loicd</span><span class="p">:</span> <span class="nv">I</span> <span class="s-Atom">think</span> <span class="nv">I</span> <span class="s-Atom">will</span> <span class="s-Atom">go</span> <span class="s-Atom">for</span> <span class="s-Atom">names</span> <span class="s-Atom">that</span> <span class="s-Atom">use</span> <span class="s-Atom">the</span> <span class="s-Atom">version</span> <span class="s-Atom">number</span> <span class="s-Atom">to</span> <span class="s-Atom">ensure</span> <span class="s-Atom">it</span> <span class="s-Atom">compares</span> <span class="s-Atom">as</span> <span class="s-Atom">expected</span> <span class="s-Atom">foo</span><span class="o">-</span><span class="mf">1.2</span><span class="o">-</span><span class="mi">1</span> <span class="s-Atom">=&gt;</span> <span class="s-Atom">foo</span><span class="o">-</span><span class="mf">1.2</span><span class="o">-</span><span class="mi">1</span><span class="s-Atom">~</span><span class="mf">7.0</span><span class="nf">wheezy</span> <span class="p">(</span> <span class="s-Atom">wheezy</span> <span class="o">=</span> <span class="s-Atom">~</span><span class="mf">7.0</span><span class="s-Atom">wheezy</span><span class="p">,</span> <span class="s-Atom">squeeze</span> <span class="o">=</span> <span class="s-Atom">~</span><span class="mf">6.0</span><span class="s-Atom">squeeze</span><span class="p">,</span> <span class="s-Atom">lenny</span> <span class="o">=</span> <span class="s-Atom">~</span><span class="mf">5.0</span><span class="s-Atom">lenny</span> <span class="s-Atom">etc</span><span class="p">.).</span> <span class="nv">What</span> <span class="s-Atom">do</span> <span class="s-Atom">you</span> <span class="s-Atom">think</span> <span class="s-Atom">?</span> 
<span class="p">(</span><span class="mi">11</span><span class="s-Atom">:</span><span class="mi">42</span><span class="s-Atom">:</span><span class="mi">31</span> <span class="nv">AM</span><span class="p">)</span> <span class="nn">daemonkeeper</span><span class="p">:</span> <span class="s-Atom">why</span> <span class="s-Atom">use</span> <span class="s-Atom">the</span> <span class="s-Atom">codename</span> <span class="s-Atom">at</span> <span class="s-Atom">all</span> <span class="s-Atom">then?</span>
<span class="p">(</span><span class="mi">11</span><span class="s-Atom">:</span><span class="mi">43</span><span class="s-Atom">:</span><span class="mi">45</span> <span class="nv">AM</span><span class="p">)</span> <span class="nn">twb</span><span class="p">:</span> <span class="nv">If</span> <span class="s-Atom">the</span> <span class="s-Atom">backport</span> <span class="s-Atom">doesn&#39;t involve a source package change, I don&#39;t</span> <span class="s-Atom">really</span> <span class="s-Atom">see</span> <span class="s-Atom">why</span> <span class="s-Atom">it&#39;s necessary to fuck about at all</span>
<span class="s-Atom">(11:45:14 AM) pabs: loicd: don&#39;t</span> <span class="s-Atom">you</span> <span class="s-Atom">want</span> <span class="s-Atom">dch</span> <span class="s-Atom">--bpo?</span>
<span class="p">(</span><span class="mi">11</span><span class="s-Atom">:</span><span class="mi">45</span><span class="s-Atom">:</span><span class="mi">53</span> <span class="nv">AM</span><span class="p">)</span> <span class="nn">loicd</span><span class="p">:</span> <span class="nn">daemonkeeper</span><span class="p">:</span> <span class="s-Atom">for</span> <span class="s-Atom">readability</span><span class="p">.</span> <span class="nv">I</span> <span class="s-Atom">agree</span> <span class="s-Atom">it&#39;s redundant.</span>
<span class="s-Atom">(11:46:06 AM) loicd: but it will help the customer support, I suppose</span>
<span class="s-Atom">(11:48:37 AM) loicd: twb: because the dependencies change and the binary packages being built are actually different. I agree that it would be completly pointless if they were python sources for instance. But in the case of compiled binaries, if the distribution is being upgraded the binary package must also be upgraded. If it had the same name it would not upgrade and be broken.</span>
<span class="s-Atom">(11:49:05 AM) twb: loicd: ah right</span>
<span class="s-Atom">(12:07:54 PM) loicd: pabs: thanks for pointing out bpo. I will follow the bpo naming scheme so that it&#39;s</span> <span class="s-Atom">compatible</span> <span class="s-Atom">with</span> <span class="s-Atom">bpo</span><span class="p">.</span> <span class="nv">And</span> <span class="s-Atom">it</span><span class="err">&#39;</span><span class="s-Atom">s</span> <span class="s-Atom">a</span> <span class="s-Atom">lot</span> <span class="s-Atom">better</span> <span class="s-Atom">to</span> <span class="s-Atom">adopt</span> <span class="s-Atom">an</span> <span class="s-Atom">existing</span> <span class="s-Atom">convention</span> <span class="p">;</span><span class="s-Atom">-</span><span class="p">)</span> <span class="nn">http</span><span class="p">:</span><span class="o">//</span><span class="s-Atom">backports</span><span class="p">.</span><span class="s-Atom">debian</span><span class="p">.</span><span class="s-Atom">org</span><span class="o">/</span><span class="nv">Contribute</span><span class="s-Atom">/#</span><span class="nf">index5h3</span> <span class="o">:-</span><span class="p">)</span>
</pre></div>


<h4>natty support and documentation</h4>
<p>Support for <a href="https://wiki.ubuntu.com/NattyNarwhal">natty</a> was added by
creating a virtual machine using <a href="http://mirrors.ircam.fr/pub/ubuntu/releases//natty/ubuntu-11.04-server-amd64.iso">the server
distribution</a>
and creating i386 and x86_64 chroots with:</p>
<div class="highlight"><pre>pbuilder --create --architecture i386 --basetgz /var/cache/pbuilder/natty-i386.tgz
pbuilder --create --architecture amd64 --basetgz /var/cache/pbuilder/natty-amd64.tgz
</pre></div>


<p>and untaring them into the packaging-farm <a href="http://packaging-farm.dachary.org/chroot/">rsync
repository</a> for
<a href="http://packaging-farm.dachary.org/chroot/debian/i386/natty/">i386</a> and
<a href="http://packaging-farm.dachary.org/chroot/debian/x86_64/natty/">x86_64</a>.The
content of the <em>packaging-farm.conf</em> was documented as a manual page:</p>
<div class="highlight"><pre>NAME
       packaging-farm.conf - define the default environment to build a package


DESCRIPTION
       The  packaging-farm command uses makefiles to run. Each package defines
       variables to influence the way it is built, as described in the packag-
       ing-farm(1)  manual  page.  The  packaging-farm.conf  file  is included
       before the package specific makefile and can be used  to  define  vari-
       ables common to all packages. The packaging-farm.conf is a makefile and
       its syntax depends on GNU make

       There are no default values. If a variable is commented out, it will be
       set to a value that triggers an error.  The default packaging-farm.conf
       file distributed contains sensible defaults, there is no fallback.   If
       they are removed, it is presumably because of a typo or an error and it
       needs to trigger an error instead of silently falling back on an  unex-
       pected default.


VARIABLES
       For  each variable listed below, the values that can be used are listed
       in the comments of the  distributed  packaging-farm.conf  file.  It  is
       important  to  check that a variable does not contain a trailing space.
       Otherwise it will be used and lead to unexpected results.


       DISTRIBUTIONS
          is the white space separated list of distributions for  which  a
          package must be built.


       ARCHITECTURES
          is  the  white space separated list of architectures for which a
          package must be built.  For each DISTRIBUTION, the package  will
          be  built  for  all ARCHITECTURES. For instance if DISTRIBUTIONS
          contains squeeze and maverick and  ARCHITECTURES  contains  i386
          and   x86_64,  the  package  will  be  built  for  squeeze+i386,
          squeeze+x86_64, maverick+i386 and maverick+x86_64.  There is  no
          way  to  ask that only i386 is built for squeeze and only x86_64
          is built for maverick.


       PACKAGES
          The list of the packages for which dependencies must  be  calcu-
          lated with

          packaging-farm depends

          so  that  package1  is  always built before package2 if package2
          depends on package1. It is recommended to not manually set  this
          variable.   Instead,  the  <span class="cp">${</span><span class="n">CACHEDIR</span><span class="cp">}</span>/build  (which  is usually
          /var/cache/packaging-farm/build ) should only  contain  directo-
          ries  matching  the  names  of  the packages to work on. And the
          variable can be set with:

          PACKAGES=$(shell ls <span class="cp">${</span><span class="n">CACHEDIR</span><span class="cp">}</span>/build)


       AUFS   The AUFS File System (http://aufs.sourceforge.net/) is  used  by
          the  packaging  farm  to  create a local copy of a chroot with a
          minimum overhead. If not available (value set  to  no)  a  rsync
          based  copy  will  be  used  instead.  This uses a lot more disk
          space.  On  Debian  GNU/Linux,  aufs  is  usually  available  by
          default and can be loaded with modprobe aufs


       CHROOT_WANTED
          The  list  of  chroot  that must be loaded in order to build the
          packages.   They   are   retrieved    from    rsync://packaging-
          farm.dachary.org/packaging-farm via the command:

          packaging-farm chroot-master-sync

          For instance

          CHROOT_WANTED=debian/i386/squeeze debian/x86_64/squeeze

          will retrieve squeeze for the i386 and x86_64 architectures. The
          chroot repository can be browsed via the web  at  http://packag-
          ing-farm.dachary.org/chroot/.   The  available chroot must cover
          all combinations of the DISTRIBUTIONS  and  ARCHITECTURES  vari-
          ables,  both in the packaging-farm.conf file and in the invivid-
          ual makefiles of each package. For  instance,  if  a  packaging-
          farm.conf  has DISTRIBUTIONS=squeeze ARCHITECTURES=i386 only but
          a package overrides this  with  DISTRIBUTIONS=wheezy  packaging-
          farm will need debian/i386/wheezy to build it.  If the distribu-
          tion is omitted, all chroot for a  given  architecture  will  be
          retrieved.

          packaging-farm CHROOT_WANTED=debian/i386 chroot-master-sync

          A  cron  job will synchronize on a daily basis. There is no need
          to manually run the synchronization, unless a specific update is
          needed immediately.  After being copied, the chroot will get the
          /etc/resolv.conf file from the host.


       CHROOT_ROOT
          Directory in which copies of the CHROOT_WANTED are kept.  As  of
          May, 2011, if CHROOT_WANTED=debian it will use 5GB.


       SUBMIT The suffix of the submit script that will be used when running:

          packaging-farm submit

          The  action  is  carried out by as script named after this vari-
          able.

          /var/lib/packaging-farm/submit/submit-<span class="cp">${</span><span class="n">SUBMIT</span><span class="cp">}</span>.sh


TROUBLESHOOTING
       check for trailing spaces in variable values
          DISTRIBUTIONS=A B with a trailing space is different  from  DIS-
          TRIBUTIONS=A  B  withing a trailing space and will lead to unex-
          pected behavior.


SEE ALSO
       submit-xivo.sh(1), packaging-farm(1)


AUTHORS
       Loic Dachary <span class="nt">&lt;loic</span><span class="err">@dachary.org</span><span class="nt">&gt;</span>



                     local      packaging-farm.conf(5)
</pre></div>


<p>The default <em>packaging-farm.conf</em> file was self documented and set with
defaultvalues so that the user only need to copy/paste from it without a
need to actuallyunderstand the details.</p>
<div class="highlight"><pre>########################################################################
#
# White space separated list of the distributions for which the packages
# must be built.
# There must be NO SPACE at the end of the line
#
# DISTRIBUTIONS=lenny squeeze wheezy unstable maverick natty
#
DISTRIBUTIONS=unstable
#
########################################################################
#
# White space separated list of the distributions for which the packages
# must be built. 
# There must be NO SPACE at the end of the line
#
# ARCHITECTURES=i386 x86_64
# 
ARCHITECTURES=x86_64
#
########################################################################
#
# The list of the packages for which dependencies must be calculated
# with
#
# packaging-farm depends
#
# so that package1 is always built before package2 if package2 depends
# on package1. It is recommended to not manually set this variable.
# Instead, the <span class="cp">${</span><span class="n">CACHEDIR</span><span class="cp">}</span>/build (which is usually 
# /var/cache/packaging-farm/build ) should only contain directories
# matching the names of the packages to work on.
# There must be NO SPACE at the end of the line
#
# PACKAGES=package1 package2
#
PACKAGES=$(shell ls <span class="cp">${</span><span class="n">CACHEDIR</span><span class="cp">}</span>/build)
#
########################################################################
#
# The AUFS File System (http://aufs.sourceforge.net/) is used by the
# packaging farm to create a local copy of a chroot with a minimum
# overhead. If not available (value set to no) a rsync based copy will
# be used instead. This uses a lot more disk space.
# On Debian GNU/Linux, aufs is usually available by default and
# can be loaded with modprobe aufs
#
#AUFS=yes
AUFS=no
#
########################################################################
#
# The list of chroot that must be loaded in order to build the
# packages. They are retrieved from rsync://packaging-farm.dachary.org/packaging-farm
# For instance:
# CHROOT_WANTED=debian/i386/squeeze debian/x86_64/squeeze 
# will retrieve squeeze for the i386 and x86_64 architectures.
#
# The values are:
#
# debian/i386/lenny
# debian/i386/maverick
# debian/i386/natty
# debian/i386/squeeze
# debian/i386/unstable
# debian/i386/wheezy
# debian/x86_64/lenny
# debian/x86_64/maverick
# debian/x86_64/natty
# debian/x86_64/squeeze
# debian/x86_64/unstable
# debian/x86_64/wheezy
#
# There must be NO SPACE at the end of the line
#
# Retreive all of debian
# CHROOT_WANTED=debian
# Retreive all of i386 debian
# CHROOT_WANTED=debian/i386
# Retreive all of x86_64 debian
# CHROOT_WANTED=debian/x86_64
#
CHROOT_WANTED=debian/x86_64/unstable
#
########################################################################
#
# Directory in which copies of the CHROOT_WANTED 
# are kept.
#
CHROOT_ROOT=/chroot
#
########################################################################
#
# The suffix of the submit script that will be used
# when running:
#
# packaging-farm submit
#
######
# Read man submit-xivo.sh(1) for more information
# SUBMIT=xivo
#####
# Not yet documented.
# SUBMIT=pokersource
#
SUBMIT=none
#
########################################################################
#
# If set, the debsign(1) command will be called to
# sign the package, if it is built successfully.
#
# debsign <span class="cp">${</span><span class="n">SIGN_debian</span><span class="cp">}</span> *.changes
#
# It should specify the key with which the package should be
# signed. The meta-packages will use SIGN_WITH to sign
# the packages.
#
#SIGN_debian=-kABCDEFGH
SIGN_debian=
#
########################################################################
#
# Sign the packages of the repository created for a meta-package
# See reprepro(1) for more information.
#
#SIGN_WITH=SignWith: yes
SIGN_WITH=
#
</pre></div>


</p>
  </div>
</article>

  <div class="pagination">
    <a class="btn" href="http://blog.xivo.io/index28.html">
      <i class="fa fa-angle-left"></i> Older Posts
    </a>
      <a class="btn float-right" href="http://blog.xivo.io/index26.html">
        Newer Posts <i class="fa fa-angle-right"></i>
      </a>
  </div>

    <footer>
<p>
  &copy; XiVO developers 2015 - This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Create Commons Attribution-ShareAlike 4.0 International License</a>
</p>
<p>Built using <a href="http://getpelican.com" target="_blank">Pelican</a> - <a href="https://github.com/alexandrevicenzi/flex" target="_blank">Flex</a> theme by <a href="http://alexandrevicenzi.com" target="_blank">Alexandre Vicenzi</a></p><p>
  <a rel="license"
     href="http://creativecommons.org/licenses/by-sa/4.0/"
     target="_blank">
    <img alt="Creative Commons License"
         title="Creative Commons License"
         style="border-width:0"
         src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png"
         width="80"
         height="15"/>
  </a>
</p>    </footer>
  </main>
<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " XiVO Blog ",
  "url" : "http://blog.xivo.io",
  "image": "public/xivo-logo.png",
  "description": ""
}
</script></body>
</html>