<!DOCTYPE html>
<html lang="en">
<head>
  <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,400italic' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" type="text/css" href="http://blog.xivo.io/theme/css/style.min.css">
  <link rel="stylesheet" type="text/css" href="http://blog.xivo.io/theme/css/pygments.min.css">
  <link rel="stylesheet" type="text/css" href="http://blog.xivo.io/theme/css/font-awesome.min.css">
  <link href="http://blog.xivo.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="XiVO Blog Atom">
  <link rel="shortcut icon" href="/public/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/public/favicon.ico" type="image/x-icon">

  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="" />
  <meta name="author" content="XiVO developers" />
  <meta name="description" content="" />
<meta property="og:site_name" content="XiVO Blog"/>
<meta property="og:type" content="blog"/>
<meta property="og:title" content="XiVO Blog"/>
<meta property="og:description" content=""/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="http://blog.xivo.io"/>
<meta property="og:image" content="public/xivo-logo.png">
  <title>XiVO Blog</title>
</head>
<body>
  <aside>
    <div>
      <a href="http://blog.xivo.io">
        <img src="public/xivo-logo.png" alt="" title="">
      </a>
      <h1><a href="http://blog.xivo.io"></a></h1>
      <p></p>
      <nav>
        <ul class="list">
          <li><a href="http://xivo.io" target="_blank">XiVO.io</a></li>
          <li><a href="http://documentation.xivo.io" target="_blank">Documentation</a></li>
        </ul>
      </nav>
      <ul class="social">
        <li><a class="sc-twitter" href="http://twitter.com/xivodevteam" target="_blank"><i class="fa fa-twitter"></i></a></li>
        <li><a class="sc-github" href="http://github.com/xivo-pbx" target="_blank"><i class="fa fa-github"></i></a></li>
        <li><a class="sc-facebook" href="https://www.facebook.com/XiVO-86529730831" target="_blank"><i class="fa fa-facebook"></i></a></li>
      </ul>
    </div>
  </aside>
  <main>
    <nav>
      <a href="http://blog.xivo.io">Home</a>
      <a href="/categories.html">Categories</a>
      <a href="/archives.html">Archives</a>
      <a href="http://blog.xivo.io/feeds/all.atom.xml">Atom</a>
    </nav>

<article>
  <header>
    <h2><a href="http://blog.xivo.io/opening-the-bootloader-for-openhardware-projects-2-u-boot-das-unterseeboot.html#opening-the-bootloader-for-openhardware-projects-2-u-boot-das-unterseeboot">Opening the bootloader for OpenHardware projects [2] : U-boot - ''Das Unterseeboot\"</a></h2>
    <p>
      Posted on Tue 23 February 2010 in <a href="http://blog.xivo.io/category/hardware.html">Hardware</a>
    </p>
  </header>
  <div>
      <p>This series of posts are dedicated to the different opensource
bootloaders available out-there that are or can be used for OpenHardware
project such as the XiVO IPBX we are currently developping.</p>
<p>This second post on the bootloaders available will present U-boot, one
the widely used bootloader for embedded systems. <strong>U-boot stands for
''Das Unterseeboot"</strong> meaning "the submarine" in German and it's also
known as "Das U-Boot -- the Universal Boot Loader".</p>
<p>U-boot is currently supporting a vast range of architectures such as:
including PPC, ARM, AVR32, MIPS, x86, 68k, Nios, and MicroBlaze
(soft-core for Xilinx FPGAs).</p>
<p>The main advantages of the different OpenSource bootloader solutions are
that they allow "userspace" features at the boot such as: interactive
commands (CLI type usually), environment variables(IP, PATH, R/W
permissions...), command scripting(typically shell scripts - namely used
in uboot-v2 a.k.a. barebox and that we will cover in the next post) and
booting from external media (or network fot TFTP rootfs and images
updates for example).</p>
<p>Einfochips <a href="1" title="1">1</a> provides a great documentation guide on how to
port uboot to a new architecture / platform with a stress on the
different files provided by u-boot and the cross-compilation issue for
the targetted platform/board/cpu.</p>
<p>Usually u-boot is stored (i.e. resides in the beginning memory area of
the flash - internal to the CPU or external-flash) in the beginning area
of the flash. This memory address (sector or block) is defined by by the
board for the very early stage of the boot (in board/xxx/init.S). The
start-up code of the processor is then defined (in cpu/arch/start.S -
like in cpu/bf533/start.S for the Blackfin processor). The boot sequence
symbols are usually noticeable as they are prefixed like "_start".</p>
<p>First stage loader: U-boot initializes the CPU and the different
peripherals on the board to allows to jump the the memory (DRAM)
subsystems. The processor core is designed to fetch instructions
starting from _START_ADDRESS_ . The core then attempts to execute the
instructions found here. Because this is the top of the memory range,
the instruction found here must be an unconditional branch instruction.
This core has to be hard-coded to configure the upper memory region so
that it is accessible without programming the external bus controller,
to which Flash memory is usually attached. This forces the requirement
to branch to a location within this address space because the processor
is incapable of addressing memory anywhere else until our bootloader
code initializes additional memory regions.</p>
<p>Second stage loader: U-boot loads itself in the RAM (SDRAM, NVRAM in the
CPU RAM or external RAM) and receives the command to boot the kernel
image. The kernel image is then uncompressed, u-boot loads it to the
memory and gives control to the kernel. The kernel will continue the
execution without u-boot.</p>
<p>This post is just a first description of U-boot and we will get more
details for specific architectures with x86 platform that we are
targetting for the XiVO IPBX project.</p>
<p><a href="1" title="1">1</a> :
http://www.einfochips.com/designers-corner/U-boot%20Porting%20guide.pdf</p>
</p>
  </div>
  <hr />
</article>
<article>
  <header>
    <h2><a href="http://blog.xivo.io/opening-the-bootloader-for-openhardware-projects-1-coreboot-and-the-bios.html#opening-the-bootloader-for-openhardware-projects-1-coreboot-and-the-bios">Opening the bootloader for OpenHardware projects [1] : Coreboot and the BIOS</a></h2>
    <p>
      Posted on Mon 15 February 2010 in <a href="http://blog.xivo.io/category/hardware.html">Hardware</a>
    </p>
  </header>
  <div>
      <p>The OpenHardware community had been seeking for more and more openess
lately in the hardware side, as well as in the software side. We see
more and more steps forward of the software side into the configuration
of the hardware (i.e. HDL projects for reconfigurable hardware such as
FPGAs and CPLDs) to reduce the constraints coming from the hardware
configuration.</p>
<p>The hardware part is composed of the schematics, pcb routing files,
gerber production files to enable the open description and output of the
features.</p>
<p>The software part is roughly composed of the bootloader (allowing the
CPU/SoC/uController to boot the memory controller and enable the
peripherals) which will indicate the memory address of the kernel.</p>
<p>In-between the hardware and the software part of the device, the
bootloader is definitely a important "glue" that should be also open to
allow users to implement their own peripherals initialization and boot
optimization of the kernel. For CPU architecture and namely x86
architecture, the booloader also known as the BIOS had been a closed
industry for quite a long time with companies such as American Trends
providing the boot sequence we all know on our PC-environment. The only
options we could have from this BIOS interface are mainly: boot
sequence, CPU frequency clocking, IRQs configuration and some memory
mappings. "Open BIOS" are then a dream of x86-based OpenHardware
projects and coreboot seems now mature enough to make this future true.</p>
<p>Previously known as LinuxBIOS, coreboot <a href="1" title="1">1</a> is a GPL project
developing an OpenSource BIOS firmware for a various number of platforms
and architecture. As we post this message, coreboot is supporting 213
different mainboards.The different supported mainboards "table of
hardware" are available
here:http://www.coreboot.org/Supported_MotherboardsThe different
chipsets supported are listed in 5 categories: north bridge (fast data
bridge), south bridge(slow data bridge), super I/Os chipsets, CPUs (x86,
PowerPC and emulated QEMU CPUs) and SoCs (AMD Elan SC520 and Intel
Tolapai EP 80579). This list is available
here:http://www.coreboot.org/Supported_Chipsets_and_DevicesThe
different payloads (that we could name also as "second stage loader")
such as the bootloaders and the kernels mainly are listed
here:http://www.coreboot.org/Payloads</p>
<p>Coreboot is now available in version 3 and provide features such as:
express boot sequence (3s to linux console, advanced network booting,
peripherals advanced support.</p>
<p>We will test Coreboot v3 on the targetted x86-based CPU chosen for the
XiVO OpenHardware IPBX and give documentation and feedbacks on the usage
feasability for this appliance in upcoming posts as well as describing
with more details the battle to open the bootloaders (once you open the
bootloader you allow the hardware hackers to play with your device
definitely).</p>
<p><a href="1" title="1">1</a>Â : http://www.coreboot.org</p>
</p>
  </div>
  <hr />
</article>
<article>
  <header>
    <h2><a href="http://blog.xivo.io/understanding-the-s0t0t1e1-isdn-protocols-and-lines.html#understanding-the-s0t0t1e1-isdn-protocols-and-lines">Understanding the S0/T0/T1/E1 ISDN protocols and lines</a></h2>
    <p>
      Posted on Mon 08 February 2010 in <a href="http://blog.xivo.io/category/hardware.html">Hardware</a>
    </p>
  </header>
  <div>
      <p>As the XiVO OpenHardware IPBX will be using 4 T0 ISDN lines, it's
important to present and educate reader on how works ISDN lines for IPBX
usage. As the telecommunications world (POTS, PSTN, GSM, ISDN, ADSL) and
the TCP/IP world are now merged into the networks we daily use, we see a
great difference between the knowledge and education of people on the
TCP/IP standards (widely used, massively understood and fine-tuned) and
the telecommunications standards and namely the ISDN (Integrated
Services Digital Network) interfaces used in PBX, IPBX or GSM networks
(E1 lines usually as used in OpenBSC project).</p>
<p>The <strong>ISDN line</strong> is a circuit-switched telephone network system
implemented on ordinary telephony copper wires on the PSTN/POTS network
to carry digital data and digital voice. The line interface is a
four-wire interface and has separated transmitter and receiver with
configurable behaviour. Every line can be switched either into S/T (four
wires - double pair) or Up (two wires - single pair) mode separately. R,
S/T and U(or Up) mode are named like this by the ITU after their current
order on the ISDN hook-up.</p>
<p>The standard ISDN line/hookup architecture looks like:</p>
<p><img alt="ISDN Hookup overview
architecture" src="/public/.ISDN_1_m.jpg" title="ISDN Hookup overview architecture, fÃ©v. 2010" /></p>
<p>TE: Terminal Equipment</p>
<p>TA: Terminal Adapter</p>
<p>NT: Network Terminator</p>
<p>S/T: Usually using 4-wires (2 pairs)</p>
<p>U: Usually using 2-wires (1 pair)</p>
<p>This overview architecture represents the standardized view of and ISDN
architecture. Operators either provide U interfaces (2-wire long
distance; the variants for interconnection to a public network are
called U0 and Uk0) or S/T interfaces (this is typically a by-country
alternative). In the latter case, a Network Termination owned by the
operator is typically installed in the customer premises because the S/T
bus is limited to a few hundred meters. If the operator provides U
interfaces, the customer can still connect its own Network Termination
and use an S/T interface behind it, or alternatively directly connect an
equipment that supports U interfaces. For private direct ISDN
connections up to a few kilometers, the 2 wire Up (Up0/UpN) interface
also exists.</p>
<p>The Universal <strong>ISDN port</strong> is developed according to the ITU-T.430 and
ETSI TBR 003 standards. It consists of the receive and transmit data
pathes with a clock processing unit each, the clock distribution unit.
The block diagram for a standard ISDN port module looks like:</p>
<p><img alt="ISDN Universal ISDN Port
Module" src="/public/.ISDN_2_m.jpg" title="ISDN Universal ISDN Port Module, fÃ©v. 2010" /></p>
<p>TE Mode: Terminal Equipment mode, the TE is always taken as
synchronisation source for ISDN applications (like the CLK is delivered
from the Central Office Switch).</p>
<p>NT Mode: Network Terminator mode, the NT mode 192kHz bit clock and the
8kHz frame clock are derived from FSYNC.</p>
<p>The ISDN line port is based on 3 layers following different standards:</p>
<p>â¢Layer 1: ITU-T I.430</p>
<p>â¢Layer 2: ITU-T Q.920, ITU-T Q.921</p>
<p>â¢Layer 3: ITU-T Q.930 and ITU-T Q.931</p>
<p>At the layer 1, the line is based on the <strong>BRI (Basic Rate Interface)</strong>
which delivers 144kbits/s (for S/T mode) broken into two 64kbits/s B
(Bearer) channel for data and one 16kbits/s D (Delta) channel for
signaling. The overhead is then added to the 144kbits/s (for a total of
196kbits/s) due to Frame Synchronization, Echo Channel (echo of the
D-channel received in NT mode to detect collision on the TX for the
D-channel when the S/T bus is shared) and Electrical Balancing bits. BRI
are popular in Europe and Japan. The B-channel uses a standard 64 kbit/s
datarate voice channel of 8 bits sampled at 8 kHz with G.711 encoding.
B-Channels can also be used to carry data, since they are nothing more
than digital channels. T0 (or S0) refers then to a BRI ISDN line
provided by the carrier to connect the IPBX to the public network.</p>
<p>The raw interface available with BRI is called T0 (in Europe). Some ISDN
carriers provide S0 interface (like the Duo/Itoo service in France for
several end-devices that can communicate between each other).In France,
the "Numeris" service provides a TNR (Terminaison Numerique de Reseau
with device such as the Sagem TNR IPS 4G) end-device that does the
conversion between the U interface and the T interface. The TNA
(Terminaison Numerique d'Abonne) does the conversion between the T
interface and the S interface. In most countries, except North-America,
the carrier provides the TNR end-device and the TNA device is provided
by the end-user customer (usually the PBX interface).</p>
<p><strong>PRI (Primary Rate Interface)</strong> are more popular in North American ISDN
carriers,</p>
<p>In Europe we see PRI E1 lines carrying 30 B-channels and 1 D-channel
(2048 kbits/s)</p>
<p>In North-America, we see PRI T1 lines carrying 23 B-channels and 1
D-channel (1544 kbits/s).</p>
<p>Japan also has PRI J1 lines similar to T1 lines with 23-B+1-D.</p>
<p>The ISDN controller chip on the hardware will be connected to the CPU
through two buses (SPI bus to control the chip and transmit D-channel
from the CPU and the PCM (also named TDM bus) bus to transmit D-channels
data with the ISDN lines). The number of simultaneous calls then had to
be calculated with the choice of the ISDN capability and the codec used
on those ones.</p>
<p>This blog post aims at giving an overview of the ISDN interface used on
the IPBX and namely in the XiVO Hardware in order to understand the
hardware project as well as the protocols used into XiVo Hardware.</p>
<p>Annexes to the article:</p>
<p><strong>More acronyms:</strong>LAP-D: Link Access Procedure on the D-channel<br />
HDLC: High-level Data-Link Control<br />
TNR (France): Terminaison NumÃ©rique de RÃ©seau<br />
TNA (france):Terminaison NumÃ©rique d'AbonnÃ©<br />
CSMA-CR: Carrier Sense Multiple Acess-Contention Resolution<br />
TEI: Terminal Endpoint Identifier<br />
SAPI: Service Access Point Identifier<br />
CEPI: Connection EndPoint Identifier  </p>
<p><strong>Multiplexing value of 64kbits/s-channels:</strong>T0: 2B+1DEurope:
2048kbits/s (30), 8448kbits/s (120), 34 368kbits/s (480), 139 264kbits/s
(1960)North-America: 1544kbits/s (24), 6312kbits/s (96), 44 736kbits/s
(1584)</p>
<p><strong>HDLC Frames Format:</strong><br />
F (Flag) | Ad (Adresses) | C (Controle) | CALL REQUEST | FCS (Frame
Controle Sequence) | F(Flag) |</p>
</p>
  </div>
  <hr />
</article>
<article>
  <header>
    <h2><a href="http://blog.xivo.io/choosing-the-right-cpusoc-for-an-openhardware-ipbx.html#choosing-the-right-cpusoc-for-an-openhardware-ipbx">Choosing the right CPU/SoC for an OpenHardware IPBX</a></h2>
    <p>
      Posted on Mon 01 February 2010 in <a href="http://blog.xivo.io/category/hardware.html">Hardware</a>
    </p>
  </header>
  <div>
      <p>Once one starts an OpenHardware project, you should be thinking about
the core of the device to be designed and namely the CPU/SoC
(System-on-Chip integrating the CPU and the peripherals controllers
built-in the chip). The CPU/SoC is the core of the system and will be
holding the BSP (BoardSupportPackage) with the Linux kernel and the
different drivers/controllers (kernel modules and drivers) and the IPBX
software core system (XiVO and Asterisk in this case) communicating with
the ISDN/FXO/FXS interfaces.</p>
<p>Ideally, to integrate the OpenHardware issue to the core of the device,
the CPU/SoC has to be as open (as in "open specifications", "open
datasheet" or "open HDL source code") as possible. Then several issues
has to be clarified such as:</p>
<p>-The smooth technical gap for users and developers to integrate, use and
hack with the OpenHardware IPBX</p>
<p>-How open can the CPU/SoC be openedÂ ? The next step will be to use
"OpenCores" CPU based on FPGA platform (such as the ones used for
OpenPattern project, the Milkymist Softcore integrating lm32 or the USRP
platform used to integrate the GnuRadio framework)</p>
<p>-What platform is "more" for existing CPU/SoC outhere between
x86/ARM/MIPS/others?</p>
<p>Lots of the current IPBX projects are mainly using the Blackfin DSP
(i.e. the Astfin project) from AnalogDevices that allows advanced DSP
(Digital Signal Processing) functions but lacks openess in terms of
specifications/data-sheets as this point.</p>
<p>Our current objectives is to target an x86 platform that smooths downs
the porting of the existing XiVO framework or the integration of a
ARM/MIPS CPU/SoC with open specifications.</p>
</p>
  </div>
  <hr />
</article>
<article>
  <header>
    <h2><a href="http://blog.xivo.io/hardware-specifications-10-of-the-xivo-appliance.html#hardware-specifications-10-of-the-xivo-appliance">Hardware specifications 1.0 of the XiVO appliance</a></h2>
    <p>
      Posted on Mon 25 January 2010 in <a href="http://blog.xivo.io/category/hardware.html">Hardware</a>
    </p>
  </header>
  <div>
      <p>The goal of the XiVO OpenHardware project is to to develop a open-specs,
open-docs appliance from the design of the hardware project to the CAD
files and production files underneath the project. The target of this
appliance is a small IPBX appliance ideal for SOHO requirements in terms
of IP-phone lines as well as analog connectivity for fax/analog lines.</p>
<p>The following bloc diagram expresses the different features targetted on
the XiVO OpenHardware project to allow the appliance to interact with 4
PSTN T0 lines, analog FXO and FXS interfaces as well as usual IP
networks connectivities, storage interfaces and configuration/debugging
interfaces.</p>
<p><img alt="XiVO Hardware
specificatons" src="/public/.XiVO_Appliance_Hardware_Specifications_m.jpg" title="XiVO Hardware specificatons, janv. 2010" /></p>
<ul>
<li>The CPU is purposely chosen with a x86 architecture to allow a
    smooth porting from the existing XiVO framework into the hardware.
    The BSP is a debian-based Linux and will be easily into this
    CPU architecture. The CPU will probably behaves as a SoC
    intregrating the different controllers for the peripherals. RAM will
    be connected</li>
</ul>
<!-- -->

<ul>
<li>ISDN Lines: 4 T0 lines which allows 8 simultaneous communications.
    These interfaces will be controlled by a ISDN chip connected to the
    CPU (SPI/TDM interfaces)</li>
</ul>
<!-- -->

<ul>
<li>Analog phone lines: The appliance is supposed to interact with
    existing PABX and to act as a PABX for the local phones on the
    SOHO network. The FXS (Foreign eXchange Subscriber) interface will
    allow the IPBX to connect to PSTN lines as a subscriber for
    analog/fax needs. The FXO (Foreign eXchange Office) interface will
    allow the IPBX to act as an analog PBX to connect local analog
    phones to the IPBX and allows a SOHO phone environment mixed between
    IP-phones and analog phones.</li>
</ul>
<!-- -->

<ul>
<li>IP Network: The XiVO IPBX will have 2 100baseT Ethernet interfaces
    for WAN/LAN IP connectivity</li>
</ul>
<!-- -->

<ul>
<li>Storage: The XiVO IPBX will have external SD, internal HDD storage
    for the BSP config files as well as for the logs, firewall rules...</li>
</ul>
<!-- -->

<ul>
<li>Debugging/Configuration: The XiVO IPBX will have a USB interface
    (USB host) allowing the connexion of external devices. Also for
    debugging and output console, the XiVO IPBX will have a RS232
    external serial interface as well as on-PCB console ports on
    the CPU.</li>
</ul>
<p>Next steps: prototyping of the different bloc diagram connected to the
EVB (EValuation Board) of the CPU based on the XiVO framework.</p>
</p>
  </div>
</article>

  <div class="pagination">
    <a class="btn" href="http://blog.xivo.io/index42.html">
      <i class="fa fa-angle-left"></i> Older Posts
    </a>
      <a class="btn float-right" href="http://blog.xivo.io/index40.html">
        Newer Posts <i class="fa fa-angle-right"></i>
      </a>
  </div>

    <footer>
<p>
  &copy; XiVO developers 2015 - This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Create Commons Attribution-ShareAlike 4.0 International License</a>
</p>
<p>Built using <a href="http://getpelican.com" target="_blank">Pelican</a> - <a href="https://github.com/alexandrevicenzi/flex" target="_blank">Flex</a> theme by <a href="http://alexandrevicenzi.com" target="_blank">Alexandre Vicenzi</a></p><p>
  <a rel="license"
     href="http://creativecommons.org/licenses/by-sa/4.0/"
     target="_blank">
    <img alt="Creative Commons License"
         title="Creative Commons License"
         style="border-width:0"
         src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png"
         width="80"
         height="15"/>
  </a>
</p>    </footer>
  </main>
<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " XiVO Blog ",
  "url" : "http://blog.xivo.io",
  "image": "public/xivo-logo.png",
  "description": ""
}
</script></body>
</html>